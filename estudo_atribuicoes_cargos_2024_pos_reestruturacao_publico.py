# -*- coding: utf-8 -*-
"""Estudo_Atribuicoes_Cargos_2024_Pos_Reestruturacao_publico.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1dyDGm-4GKQRjqC5psOOD9Di8Ez7EHYBm

#1 - Tabelas com Atributos e Cargos

Abaixo estão as bibliotecas as quais permitiram a manipulação, limpeza, processamentos, reduções e visualizações dos dados.

##Bibliotecas
"""

#instalando gower library para utilizar o Gower Distance Measurament
!pip install gower

#Bibliotecas utilizadas
from google.colab import files #Carregar arquivos CSV mais fácil
import csv  #Trabalhar CSV mais
import numpy as np #Biblioteca de séries necessária para o Pandas
import pandas as pd #Principal biblioteca da DS
import seaborn as sns #Melhorando Gráficos
import matplotlib.pyplot as plt #Utilizar gráficos no Python
import matplotlib.patches as mpatches #Anotações nos gráficos
import matplotlib.font_manager as fm #tamanho da fonte nas legendas
import networkx as nx #Diagramas de Grafos
import gower #Organizador segundo lógica de Gower
import re #Trabalhando com regex
from sklearn.model_selection import train_test_split #Testes científicos e treinamentos das descisões
from sklearn.metrics import accuracy_score #Checando acurácia das medidas
from sklearn.cluster import AgglomerativeClustering #Agrupamentos como o Scatterplot
from scipy.spatial import distance #Medições relativas de distâncias
from scipy.spatial.distance import pdist #tabela de distâncias
from scipy.spatial.distance import squareform #elevando tabela de distâncias ao quadrado
from scipy.cluster.hierarchy import linkage, fcluster, dendrogram #utilização de linkages e dendogramas
from scipy.cluster.hierarchy import cophenet #indíce cofenético
from sklearn.tree import DecisionTreeClassifier, plot_tree #árvore de decisão
import math #cálculos avançados de matemática
import random #número aleatórios para teste da IA Classificadora
from collections import Counter #Contar itens em uma lista

"""Inicialmente, todos os editais de concursos públicos de cada um dos cargos atuais foram obtidos, a fim de que as atribuições previstas de cada um fossem compiladas. Considerando que nem todos os cargos possuem lei ou documentos oficiais listando suas atribuições, optou-se pelos editais, por serem uma forma mais equânime de comparação. Apesar de não haver força normativa, há de se ressaltar que estas listas de atribuições nos editais de concursos trazem o que os cargos possuem de inerentes, haja vista sempre todas as listas de todos os cargos iniciarem com a frase “São atribuições inerentes ao exercício do cargo de...” (com exceção dos cargos de fotógrafo técnico pericial, desenhista técnico pericial, auxiliar de necrotério policial e atendente de necrotério policial, os quais só indicam quais atribuições estão listadas sem indicar serem “inerentes”), de forma que os ignorá-las ou alterá-las levianamente pode suscitar alteração da essência do cargo. Se não houvesse necessidade de atenção a essas atribuições, não seria necessário as colocar nos editais ou mesmo qualquer tipo de atribuições poderiam ser colocadas, por mais absurda que essas fossem. Estas listas de atribuições servem de espécie de “termômetro”, o qual demonstra aos candidatos e servidores dos cargos quais atribuições são esperadas deles, e quais não são, de forma expressa e concisa e normalmente espelhando leis quando essas existem.

A tabela abaixo mostra as seguintes colunas:

**Edital - Portaria:** Ano do Edital ou menção da Portaria 30 de 2012, com atribuições comuns a todas as carreiras.

**Carreira:** Menciona a carreira do documento.

**num_atrib:** Contador de atribuições do documento.

**mantida - retirada:** se a atribuição foi mantida inicialmente para saber quais são as atribuições comuns (Portaria 30/2012), mantida e utilizada até o fim do estudo ou retirada por se tratar do rol comum.

**Reduzida:** Condensação da essência da atribuição em oração menor. Quando a essência era a mesma em cargos distintos, somente uma oração reduzida era mantida.

**Mesclada:** Quando várias atribuições listadas no documento só faziam menção a uma atribuição. No processamentos, todas essas atribuições foram mescladas em somente uma reduzida.
"""

#Carregando o arquivo
#QUANDO O ENCODING UTF-8 DER PROBLEMA, UTILIZAR ISO-8859-1
uploaded = files.upload()
tabela_atrib_editais = pd.read_csv('Atribuicoes_Carreiras_Editais.CSV', encoding='iso-8859-1', sep=';')

"""Verificando leitura do documento."""

#Verificando o arquivo
print(tabela_atrib_editais.to_string())

"""Tabela melhor visualizada em Dataframe."""

tabela_atrib_editais

"""Com esta tabela e comando simples, pode-se listar as orações de cada cargo. Abaixo estão eles, conforme o código colocado, iniciando pelas atribuições de todas as carreiras."""

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Todas']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Delegado de Polícia']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Escrivão de Polícia']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Investigador de Polícia']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Perito Criminal']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Médico Legista']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Papiloscopista Policial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Auxiliar de Papiloscopista Policial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Agente de Telecomunicações Policial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Agente Policial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Carcereiro Policial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Fotógrafo Técnico Pericial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Desenhista Técnico Pericial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Auxiliar de Necrópsia Policial']

tabela_atrib_editais.loc[tabela_atrib_editais['Carreira'] == 'Atendente de Necrotério Policial']

"""Também é possível fazer diferentes filtros, como os a seguir.
Atribuições retiradas.
"""

tabela_atrib_editais.loc[tabela_atrib_editais['mantida - retirada'] == 'retirada']

"""Atribuições mescladas"""

tabela_atrib_editais.loc[tabela_atrib_editais['Mesclada'] == 's']

"""É possível ver o número de atribuições de cada cargos, desconsiderando as retiradas ou mescladas."""

for carreira in tabela_atrib_editais['Carreira'].unique():
  print(f"Carreira: {carreira}")
  filtered_df = tabela_atrib_editais[tabela_atrib_editais['Carreira'] == carreira]
  filtered_df = filtered_df[filtered_df['Reduzida'] != "X"]
  total_atribuicoes = len(filtered_df['Reduzida'].unique())
  if filtered_df[filtered_df['Carreira'] == "Todas"].any:
    print(f"Total de Atribuições: {total_atribuicoes}")
  elif filtered_df[filtered_df['Carreira'] == "Carcereiro Policial"]:
    print("Total de Atribuições: 0")
  else:
    print(f"Total de Atribuições: {total_atribuicoes}") #Remover 1 devido os "X" das retiradas
  print("-" * 60)

"""##1.1 Análises iniciais

###1.1.1 Atual sem correção

####1.1.1.1 Original

Inicialmente, foi trabalhada a tabela de atribuições sem correções, ou seja, colocando valores de presença somente a relativos aos editais e portaria 30.

Abaixo leitura da tabela binária de atribuições em CSV.
"""

#Carregando o arquivo
#QUANDO O ENCODING UTF-8 DER PROBLEMA, UTILIZAR ISO-8859-1
uploaded = files.upload()
cargos_atrib_atual_nocor = pd.read_csv('01 - Atrib Atual No Cor.CSV', encoding='iso-8859-1', sep=';')

"""Verificação se a tabela foi completa."""

#Verificando o arquivo
print(cargos_atrib_atual_nocor.to_string())

"""Transformação em DataFrame."""

cargos_atrib_atual_nocor

"""Possível verificar que são 14 linhas (carreiras) e 72 colunas (atribuições), totalizando 1008 células com valores 0 ou 1."""

def heatmap_tabela_atrib(tabelaAtribBin, titulo, color_map):
  tabelaBinariaColor = tabelaAtribBin.set_index('Carreira')

  # Convert all columns to numeric, replacing errors with NaN
  tabelaBinariaColor = tabelaBinariaColor.apply(pd.to_numeric, errors='coerce')

  fig, ax = plt.subplots(figsize=(18, 12))

  # Use tabelaBinariaColor for both heatmaps
  heatmap = sns.heatmap(tabelaBinariaColor, annot=True, cbar=False)
  sns.heatmap(tabelaBinariaColor, cmap=color_map, vmin=0, vmax=1,
              center=0, linewidths=1, annot=True, square=True,
              linecolor='black', cbar=False)

  ax.set(xlabel=None)
  ax.set(ylabel=None)
  plt.title(titulo, fontsize=20)
  plt.show()

titulo = "Tabela Binária - Atual Original Sem Correção Total"
color_map = "BrBG"

heatmap_tabela_atrib(cargos_atrib_atual_nocor, titulo, color_map)

#Verificação dos dados
cargos_atrib_atual_nocor.head(14)

"""Primeiro, descobrir quais atributos são comuns a todos os cargos."""

cargos_atrib_atual_nocor.loc[:, (cargos_atrib_atual_nocor == 1).all()]

cols_all_ones = cargos_atrib_atual_nocor.loc[:, (cargos_atrib_atual_nocor == 1).all()].columns.tolist()
print('Atribuições de todos os cargos:')
cols_all_ones

"""A lista acima é aquela com as atribuições comuns de todos os cargos, o qual é ignorada por não possuir valor discriminatório entre carreiras."""

#Retirando cargos comuns a todos do DF.
atrib_gerais_no_cor = cargos_atrib_atual_nocor.drop(cols_all_ones, axis=1)
#atrib_gerais_no_cor

"""Tabela binária colorida sem os atributos comuns."""

titulo = "Tabela Binária - Atual Original Sem Correção"
color_map = "BrBG"

heatmap_tabela_atrib(atrib_gerais_no_cor, titulo, color_map)

"""É possível elencar a atribuição por carreira com a função 'atrib_por_carreira'. A lista segue abaixo. Essas listas podem dar o panorama geral sem retirar as atribuições repetidas."""

def atrib_por_carreira(df):
  print("Atribuições por Carreira:")
  for index, row in df.iterrows():
    print("Carreira:", df.Carreira[index])
    for item in row[row == 1].index.tolist():
      print(item)
    print("Total Atribuições:", len(row[row == 1].index.tolist()))
    print("-" * 60)
  print (f"Total de Atribuições da Tabela:", len(df.columns)-1 )

atrib_por_carreira(atrib_gerais_no_cor)

"""Com exceção das atribuições comuns de todos os cargos, esses são as atribuições de cada cargo, verificando-se quais são os comuns a mais de um. Nesta lista já é possível verificar algumas inconsistências não intencionais dos editais, já que cada um foi pensado separadamente e levando em conta somente a carreira delineada na hora. São essas atribuições compartilhadas as quais permitiram o cálculo de similitude entre cargos, ainda que pouco em comparação com a totalidade de atribuições. As incongruências serão corrigidas na parte corrigida."""

def atrib_comp(df):
  print("Atribuições Compartilhadas:")
  for column in df.columns:
    # Convert the column to numeric type before calculating the sum
    if pd.to_numeric(df[column], errors='coerce').sum() > 1:
      print("Atribuição:", column)
      cont = 0
      print("Carreiras:")
      for index, row in df.iterrows():
        if row[column] == 1:
          cont += 1
          print(row['Carreira'])
      print("Total Carreiras:", cont)
      print("-" * 60)

atrib_comp(atrib_gerais_no_cor)

"""É interessante também ver quais atribuições são compartilhadas a partir de dois cargos, como abaixo mostrado. Essa lista é muito útil quando compara-se o diagrama de grafos."""

def atrib_comp_cargos(df):
  for i in range(0, len(df)):
    j = i + 1
    for j in range(j, len(df)):
      carreira1 = df.iloc[i]['Carreira']
      carreira2 = df.iloc[j]['Carreira']
      shared_cols = df.columns[(df.iloc[i] == 1) & (df.iloc[j] == 1)]
      if shared_cols.any():
        print(f"Carreiras: {carreira1} x {carreira2}")
        print("Atribuições Compartilhadas:")
        for atrib in shared_cols:
          print(atrib)
        print(f"Total: {len(shared_cols)}")
        print("-" * 60)

atrib_comp_cargos(atrib_gerais_no_cor)

"""Abaixo estão a lista de atribuições exclusivas de cada cargo. É aqui que pode-se ver a verdadeira essência de cada cargo, e se suas atribuições são de natureza investigativa, pericial ou de apoio."""

def atrib_excl(df):
  print("Atribuições Exclusivas:")
  for index, row in df[(df == 1).any(axis=1)].iterrows():
    print("Carreira:", df.Carreira[index])
    cont = 0
    for col in df.columns:
      if row[col] == 1 and (df[col] == 1).sum() == 1:
        cont += 1
        print(col)
    print("Total Atribuições:", cont)
    print("-" * 60)

atrib_excl(atrib_gerais_no_cor)

"""Com essas listas, é possível listar as atribuições exclusivas e compartilhadas para efeitos comparativos. No contexto deste trabalho, serão apresentadas as seguintes listas para comparação mais diretas.

1ª LISTA: ATRIBUIÇÕES EXCLUSIVAS DE PERITO CRIMINAL

2ª LISTA: ATRIBUIÇÕES COMPARTILHADAS ENTRE PERITO CRIMINAL E PAPILOSCOPISTA POLICIAL

3ª LISTA: ATRIBUIÇÕES EXCLUSIVAS DE PAPILOSCOPISTA POLICIAL

4ª LISTA: ATRIBUIÇÕES COMPARTILHADAS ENTRE PAPILOSCOPISTA POLICIAL E INVESTIGADOR DE POLÍCIA

5ª LISTA: ATRIBUIÇÕES EXCLUSIVAS DE INVESTIGADOR DE POLÍCIA

As escolhas entre essas cargos são as seguintes:
- A LONPC só trouxe em sou bojo os cargos de delegado de polícia, oficial investigador de polícia (o que seria hoje o mais próximo de investigador de polícia, sem correções e ignorando aglutinações com outroas cargos) e perito oficial criminal (em gênero, levando em conta a lei e as decisões do STF, mas só utilizaremos o Perito Criminal aqui para efeitos comparativos).
- Por óbvio, o Delegado de Polícia somente fica disponível para bacharéis em direito e que tenham passado em concurso público para este concurso.
- Em São Paulo, existe o cargo de Auxiliar de Papiloscopista Policial. Este foi deixado de lado pois se "assemelha" ao Papiloscopista Policial assim como os cargos de apoio pericial, por exemplo o Fotógrafo Técnico Policial e Desenhista Técnico Policial com o Perito Criminal, e o Auxiliar de Necrópsia Policial e o Atendente de Necrotério Policial com o Médico Legista. O Auxiliar de Papiloscopista Policial caso fosse colocado conjuntamente com o Papiloscopista Policial poderia ensejar 'ascenção' inconstitucional pois não possui atribuições precipuamentes periciais, somente de apoio a perícia.
"""

def lista_exclusivas_compartilhadas_Ncargos(lista_cargos_select, df_original):
  df_copia = df_original.copy()

  #Retirando todas as colunas com somente valores 0 nos cargos restantes (sem atribuição)
  cols_all_zeros = df_copia.loc[:, (df_copia == 0).all()].columns.tolist()
  #cols_all_zeros
  df_copia = df_copia.drop(cols_all_zeros, axis=1)

  #Setando "Carreira como index"
  df_copia = df_copia.set_index('Carreira')

  #Gerando listas com atribuições exclusivas e compartilhadas dos cargos selecionados
  tamanho_listas = ((len(lista_cargos_select)*2)-1)
  for i in range (0, tamanho_listas):
    if (i % 2 == 0):
      pos = i // 2
      carreira_atual = lista_cargos_select[pos]
      print("Atribuições Exclusivas - Carreira:", carreira_atual)
      cont = 0
      for col in df_copia.columns:
        if df_copia.loc[carreira_atual][col] == 1 and (df_copia[col] == 1).sum() == 1 and carreira_atual in lista_cargos_select:
          cont += 1
          print(col)
      print("Total Atribuições:", cont)
      print("-" * 60)
    else:
      pos = i // 2
      pos_after = pos + 1
      carreira1 = lista_cargos_select[pos]
      carreira2 = lista_cargos_select[pos_after]
      if carreira1 in lista_cargos_select and carreira2 in lista_cargos_select:
        shared_cols = df_copia.columns[(df_copia.loc[carreira1] == 1) & (df_copia.loc[carreira2] == 1) & (df_copia.drop(index=[carreira1, carreira2]).sum() > 0)]
        print(f"Atribuições Compartilhadas - Carreiras: {carreira1} x {carreira2}")
        for atrib in shared_cols:
          print(atrib)
        print(f"Total: {len(shared_cols)}")
        print("-" * 60)
  print(f"Total de atribuições analisadas nesta tabela: {len(df_copia.columns)}")

#Cargos a selecionar
lista_cargos_select = ['Perito Criminal', 'Papiloscopista Policial', 'Investigador de Polícia']

lista_exclusivas_compartilhadas_Ncargos(lista_cargos_select, atrib_gerais_no_cor)

"""É possível verificar das listas de cargos atuais sem correções entre todos os cargos, entre Perito Criminal, Papiloscopista Policial e Investigador de Polícia:

1. O Perito Criminal possui 10 atribuições exclusivas. (16,13%)
2. Perito Criminal e Papiloscopista Policial compartilham 2 atribuições. (3,23%)
3. O Papiloscopista Policial possui 8 atribuições exclusivas. (12,90%)
4. NÃO há atribuições compartilhadas entre Papiloscopista Policial e Investigador de Polícia.(Zero – 0%)
5. O investigador de Polícia possui 6 atribuições exclusivas.(9,68%)
6. A tabela total com as 62 atribuições. (100%)
7. Total de atribuições nas análises de atribuições exclusivas e compartilhadas: 26 (41,94%).

####1.1.1.2 Condensada

A quantidade / magnitude de atribuições impacta diretamente nos valores de distância e representações, com exceção do Diagrama de Grafos. Dessa forma, para evitar ensejar viés devido a quantidade de atribuições, as colunas que possuem os valores idênticos em todos as linhas entre elas podem ser aglutinadas. O valor total passa a ser não o número de atributos, mas sim a quantidade de colunas. Essas tabelas são denominadas tabelas condensadas.
"""

def df_condensado_e_reducoes(df_original):
  global df_condensed
  df_condensed = df_original
  df_condensed = df_condensed.drop(cols_all_ones, axis=1)

  loop_keeper = 0
  global historico_juncoes
  historico_juncoes = []
  nome_atribuicao_juntada = ''
  cont_reducoes = 0

  while loop_keeper == 0:
    loop_keeper = 1 # encerra se não há mais colunas duplicadas

    # Lista de nome das colunas
    columns = list(df_condensed.columns)

    # Iterando com o nome das colunas
    for i in range(len(columns)):
      for j in range(i + 1, len(columns)):  # Envitando auto comparação
        # Acessando colunas com seus nomes
        if df_condensed[columns[i]].equals(df_condensed[columns[j]]):
          cont_reducoes += 1
          # Historico de Reduções pode informar as reduções de forma progressiva
          historico_juncoes.append("Redução Nº " + str(cont_reducoes) + ": (" + columns[i] + ' / ' +  columns[j] + ")")
          #Juntando nomes em uma das colunas para manter gravação dos nomes
          nome_atribuicao_juntada = columns[i] + ' / ' +  columns[j]
          # Renomeando colunas com nomes juntados
          df_condensed = df_condensed.rename(columns={columns[i]: nome_atribuicao_juntada})
          # Reduzindo o DataFrame
          df_condensed = df_condensed.drop(columns[j], axis=1)
          # Reset do Loop Keeper para procurar mais dupliocatas
          loop_keeper = 0
          # Sai do loop pois houve alteração de número de colunas
          break
      # Se forem encontradas colunas iguais, sai do loop e recomeça
      if loop_keeper == 0:
        break

  return df_condensed, historico_juncoes

cargos_atrib_atual_nocor_condensed, cargos_atrib_atual_nocor_hist_redux = df_condensado_e_reducoes(cargos_atrib_atual_nocor)

cargos_atrib_atual_nocor_condensed

"""Tabela binária condensada colorida."""

titulo = "Tabela Binária - Atual Condensada Sem Correção"
color_map = "PRGn"

heatmap_tabela_atrib(cargos_atrib_atual_nocor_condensed, titulo, color_map)

cargos_atrib_atual_nocor_hist_redux

"""Calculando redução de colunas em números absolutos."""

def quant_colunas_reduzidas(df_original, df_condensed):
  quant_cols_redux = len(df_condensed.columns) - 1
  print("Quantidade de atribuições da tabela condensada: ", quant_cols_redux)
  quant_cols_original = len(df_original.drop(cols_all_ones, axis=1).columns) - 1
  print("Quantidade de atribuições da tabela original: ", quant_cols_original)
  print("Quantidade reduzida: ", quant_cols_original - quant_cols_redux)

quant_colunas_reduzidas(cargos_atrib_atual_nocor, cargos_atrib_atual_nocor_condensed)

"""Foram reduzidas de 62 atribuições para 18 no total, redução de 44.

É possível também elencar com as reduções quais colunas são mais "separadoras de carreiras", e quais são mais basais. Aquelas que tem soma 1 na coluna são exclusivas. Soma 2, somente dois cargos compartilham, e assim consecutivamente. Com esses resultados é possível elencar algoritmos os quais classifiquem por atribuições condensadas exclusivas, ou mesmo gerar grupos de proximidade entre atribuições compartilhadas por poucas carreiras.  
"""

def atrib_cond_por_carreira(df_condensed):
  #Procurando a coluna com a maior soma
  df_copia = df_condensed.set_index('Carreira')
  soma_max = 0

  for column_name in df_copia.columns:
      soma_atual = df_copia[column_name].sum()
      if soma_atual > soma_max:
          soma_max = soma_atual

  #Imprimindo cada coluna (atribuição) com as carreiras (linhas) que participam da soma
  for i in range(soma_max):
    for column in df_copia.columns:
      if pd.to_numeric(df_copia[column], errors='coerce').sum() == i:
        if i == 1:
          print("Atribuições condensadas de 1 Cargo (Exclusivas):")
        else:
          print("Atribuições condensadas de", i,"Cargos (Compartilhados):")
        print(column)
        if i > 1:
          print("Carreiras:")
        for index, row in df_copia.iterrows():
          if row[column] == 1:
            print(index)
        print("-" * 60)

atrib_cond_por_carreira(cargos_atrib_atual_nocor_condensed)

"""Observando a lista feita, é possível deduzir:
1. Qualquer policial civil de São Paulo que tenha alguma das atribuições exclusivas automaticamente estaria classificado naquela carreira, caso nenhuma mudança dos parâmetros desse estudo fosse feita. São atribuições condensadas de ordem de "espécie".
2. Atribuições compartilhadas entre menos cargos aproximam mais esses cargos do que atribuições entre mais cargos, desconsiderando erros nas elaborações dos editais. Essas atribuições são de ordem de "gênero".
3. Cargos que compartilham atribuições tendem a ser de um mesmo grupo ou de grupos mais aparentadados (exemplo, perícia ou apoio à perícia).

Na lista apresentada, os subgrupos gerados poderiam ser classificados como:
1. Segurança em local de crime: Investigador de Polícia e Desenhista Técnico Pericial. Contudo, essa ligação aparentemente foi uma conexão espúria entre editais criados separadamente.
2. Apoio à perícia criminalística: Fotógrafo Técnico Pericial e Desenhista Técnico Pericial.
3. Análise Papiloscópica em local de crime: Perito Criminal, Papiloscopista Policial e Auxiliar de Papiloscopista Policial.
4. Exames com cadáveres: Perito Criminal, Médico Legista e Auxiliar de Necrópsia Policial.

###1.1.2 Atual com correção

Observando a situação atual com correção proposta de atribuições, e junção de agente de telecomunicações, agente policial e carcereiro com investigador. A reestruturação dos cargos trouxe esse três como um agente de polícia judiciária. Apesar deste fato, decidiu-se manter os três na correção e nos próximos estudos da LONPC conjuntamente com o Investigador de polícia por não haver atribuições precípuas encontradas em nenhum desses cargos.

As atribuições que não estão listadas para os cargos mas as quais esses exercem passam a receber 1 na tabela, corrigindo sua ausência nos editais. Os cargos de perícia recebem quando oportuno todos as atribuições dos cargos de apoio dessas. O inverso não ocorre pois os cargos de apoio não são peritos. Realizar tal fato seria dizer que o Auxiliar de Papiloscopista Policial seria tão perito como Papiloscopista, assim como o Fotógrafo Técnico Pericial e o Desenhista Técnico Pericial seriam como o Perito Criminal, ou mesmo o Auxiliar de Necrópsia Policial ou Atendente de Necrotério Policial como Médico Legista.

A.	Atributo “Atuar na investigação”: investigador recebe valor 1, por obviedade. Agente policial também recebe valor 1, já que vem realizando o trabalho de investigadores.

B.	Agente policial recebe os seguintes valores positivos: diligência e prevenção especializada de crimes, cumprir mandados, realizar prisões, segurança de locais de polícia judiciária, intervir em ocorrência policiais, transporte de pessoas / coisas de ocorrência policial, manusear armas de fogo e menos letais.

C.	Análise de vestígios em local de crime ou laboratório: papiloscopista e auxiliar de papiloscopista recebem valor 1, haja vista laboratório e revelação em peças no IIRGD (e câmaras improvisadas em delegacias) e verificar locais de crime em busca de vestígios materiais de natureza biológica do tipo papiloscópica.

D.	cumprir requisições do ramo da criminalística / operar equipamentos: médico legista e papiloscopista recebem valor 1, haja vista as ciências da Medicina legal atuar nos vestígios materiais superficiais e internos do corpo humano, e a Papiloscopia estar abarcada no rol de disciplinas da criminalística por tratar de vestígios materiais em locais de crime com perícia. Ambos são inqueridos pelo juiz para explicar suas artes como especialistas na área. Ademais, ambos operam equipamentos para fazerem suas perícias.

E.	examinar locais de crime: papiloscopista e auxiliar de papiloscopista recebem valor 1, haja vista o trabalho pericial em locais de crime em busca de vestígios materiais de natureza biológica do tipo papiloscópica.

F.	manusear materiais biológico: papiloscopista e auxiliar de papiloscopista recebem valor 1, haja vista o trabalho pericial em locais de crime com objetos contaminados em busca de vestígios materiais de natureza biológica do tipo papiloscópica.

G.	zelar pela cadeia de custódia: todos os cargos afeitos a perícia recebem valor 1 (perito criminal, médico legista, papiloscopista policial, auxiliar de papiloscopista policial, fotógrafo técnico policial, desenhista técnico policial, auxiliar de necrópsia e atendente de necrotério.

H.	papiloscopia em pessoas desaparecidas: auxiliar de papiloscopista recebe valor 1, haja vista realizar este trabalho em delegacia e desaparecidos.

I.	O papiloscopista recebe valor 1 em todos as atribuições do auxiliar de papiloscopista. O contrário não ocorre por não previsão pericial do cargo.

J.	O perito criminal recebe valor 1 em todas dos fotógrafos técnicos periciais e desenhistas técnicos periciais, com exceção de auxiliar a perícia SPTC.

K.	O médico legista recebe todas as atribuições do auxiliar de necrópsia e do atendente de necrotério, com exceção de transporte de cadáveres e limpar cadáveres.

L.	Editar laudos tem valor 1 para perito criminal, médico legista e papiloscopista policial, e o fotógrafo técnico pericial recebe valor 0, já que essa edição é feita pelo perito em si, e não por um agente de apoio à perícia.

M.	projeções de envelhecimento e rejuvenecimento: desenhista técnico pericial recebe valor 1, haja vista o trabalho desse cargo em retratos falados.

N.	elaborar recognição visuográfica: todos os cargos recebem 1, haja vista este documento ser passado a todos eles durante o curso da academia, reduzindo o número total de atribuições sem as comuns a todos de 62 para 61.

O.	Retrato Falado: desenhista técnico pericial recebe 1, já que faz também tal parte.

Abaixo leitura da tabela CSV.

####1.1.2.1 Original
"""

uploaded = files.upload()
cargos_atrib_atual_withcor = pd.read_csv('02 - Atrib Atual With Cor.CSV', encoding='iso-8859-1', sep=';')

"""Verificação se a tabela foi completa."""

#Verificando o arquivo
print(cargos_atrib_atual_withcor.to_string())

"""Remoção dos atributos de todos os cargos."""

cargos_atrib_atual_withcor.loc[:, (cargos_atrib_atual_withcor == 1).all()]
cols_all_ones = cargos_atrib_atual_withcor.loc[:, (cargos_atrib_atual_withcor == 1).all()].columns.tolist()
atrib_gerais_with_cor = cargos_atrib_atual_withcor.drop(cols_all_ones, axis=1)

"""Tabela binária colorida sem os atributos comuns."""

titulo = "Tabela Binária - Atual Original Com Correção"
color_map = "PiYG"

heatmap_tabela_atrib(atrib_gerais_with_cor, titulo, color_map)

"""Atribuições por carreira."""

atrib_por_carreira(atrib_gerais_with_cor)

"""Atribuições compartilhadas e seus cargos."""

atrib_comp(atrib_gerais_with_cor)

"""Atribuições exclusivas de cada cargo."""

atrib_excl(atrib_gerais_with_cor)

"""Abaixo a lista de cargos exclusivos e compartilhados entre Perito Criminal, Papiloscopista Policial e Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial)."""

#Cargos a selecionar
lista_cargos_select = ['Perito Criminal', 'Papiloscopista Policial', 'Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial)']

lista_exclusivas_compartilhadas_Ncargos(lista_cargos_select, atrib_gerais_with_cor)

"""É possível verificar das listas de cargos atuais com correções entre todos os cargos, entre Perito Criminal, Papiloscopista Policial e Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial):

1. O Perito Criminal possui 6 atribuições exclusivas (9,84%).
2. Perito Criminal e Papiloscopista Policial compartilham 10 atribuições (16,39%).
3. O Papiloscopista Policial possui 3 atribuições exclusivas (4,92%).
4. NÃO há atribuições compartilhadas entre Papiloscopista Policial e Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial) (Zero – 0%).
5. O investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial) possui 6 atribuições exclusivas (9,84%).
6. A tabela total com as 61 atribuições.(100%)
7. g.	Total de atribuições nas análises de atribuições exclusivas e compartilhadas: 25 (40,98%).

####1.1.2.2 Condensada

Abaixo a geração de tabelas condensadas.
"""

cargos_atrib_atual_withcor_condensed, cargos_atrib_atual_withcor_hist_redux = df_condensado_e_reducoes(cargos_atrib_atual_withcor)

cargos_atrib_atual_withcor_condensed

"""Tabela binária condensada colorida."""

titulo = "Tabela Binária - Atual Condensada Com Correção"
color_map = "BrBG"

heatmap_tabela_atrib(cargos_atrib_atual_withcor_condensed, titulo, color_map)

cargos_atrib_atual_withcor_hist_redux

"""Quantidade de colunas reduzidas."""

quant_colunas_reduzidas(cargos_atrib_atual_withcor, cargos_atrib_atual_withcor_condensed)

"""Observa-se que as correções geraram menos reduções em comparação com as tabelas não corrigidas.

A seguir as atribuições condensadas por carreiras.
"""

atrib_cond_por_carreira(cargos_atrib_atual_withcor_condensed)

"""Observando as atribuições compartilhadas, já que as exclusivas servem para efeitos de especificação, e a análise nesta etapa é de gênero, é possível suscitar, sem listar o idêntico ao no estudo sem correções:
1. Escrivão de Polícia e Investigador de Polícia fazem parte do grupo "investigação" com "atuar na investigação".
2. Papiloscopista Policial e Auxiliar de Papiloscopista possuem várias atribuições condensadas do ramo da papiloscopia geral, não pericial, já que as atribuições pericias do ramos da papiloscopia são exclusivas do Papiloscopista Policial.
3. Papiloscopista Policial e Desenhista Técnico Pericial são os que realizam trabalhos com face da maneira que estão delineados as atribuições por editais atualmente.
4. Perito Criminal e Fotógrafo Técnico Pericial se aproximam pois o Perito Criminal recebe as funções do Fotógrafo.
5. Perito Criminal e Desenhista Técnico Pericial se aproximam por trabalharem com desenhos planimétricos.
6. Médico Legista se aproxima do Auxiliar de Necrópsia Policial e Atendente de Necrotério Policial pois recebe boa parte das funções desses.
7. Perito Criminal, Papiloscopista Policial e Auxiliar de Papiloscopista Policial se aproximam por trabalharem com análise de análises de papiloscopia em local de crime.
8. Perito Criminal, Papiloscopista Policial e Médico Legista se aproximam pois executam muitas de atribuições periciais, como cumprir requisições do ramo da criminalística / atender ocorrências de desastres / operar aparelhos forenses / editar laudos periciais.
9. Médico Legista, Papiloscopista Policial e Auxiliar de Necrópsia se aproximam por estarem afeitos na identificação de cadáveres.
10. Perito Criminal, Médico Legista, Papiloscopista Policial e Auxiliar de Papiloscopista Policial se aproximam pois examinam locais de crime.
11. Perito Criminal, Papiloscopista Policial, Auxiliar de Papiloscopista Policial e Desenhista Técnico Pericial se aproximam por realizar levantamento de local com desenhos e fotos.

###1.1.3 LONPC sem correção

####1.1.3.1 Original

Investigador, agora denominado Oficial Investigador de Polícia (OIP) é aglutinado com Escrivão, Agente de Telecomunicações, Agente Policial e Carcereiro.

O Papiloscopista Policial é redenominado Perito Papiloscopista. O Auxiliar de Papiloscopista é redenominado Agente de Perícia Papiloscópica.

O Fotógrafo Técnico Pericial e o Desenhista Técnico Pericial são aglutinados no Agente de Perícia Criminalística.

O Atendente de Necrotério e Auxiliar de Necrópsia são aglutinados no Agente de Perícia Médico Legal.

Sem as correções propostas no item 1.1.2, somente as aglutinações da LONPC e proposta de restruturação, com ajustes mais lógicos entre a Lei maior e a restruturação.

Abaixo a leitura da tabela binária.
"""

uploaded = files.upload()
cargos_atrib_LONPC_nocor = pd.read_csv('03 - Atrib LONPC No Cor.CSV', encoding='iso-8859-1', sep=';')

"""Verificação da leitura da tabela."""

#Verificando o arquivo
print(cargos_atrib_LONPC_nocor.to_string())

"""Remoção de atribuições comuns a todos."""

cargos_atrib_LONPC_nocor.loc[:, (cargos_atrib_LONPC_nocor == 1).all()]
cols_all_ones = cargos_atrib_LONPC_nocor.loc[:, (cargos_atrib_LONPC_nocor == 1).all()].columns.tolist()
atrib_gerais_LONPC_no_cor = cargos_atrib_LONPC_nocor.drop(cols_all_ones, axis=1)

"""Tabela binária colorida sem os atributos comuns."""

titulo = "Tabela Binária - LONPC Original Sem Correção"
color_map = "PuOr"

heatmap_tabela_atrib(atrib_gerais_LONPC_no_cor, titulo, color_map)

"""Atribuições de cada carreira."""

atrib_por_carreira(atrib_gerais_LONPC_no_cor)

"""Atribuições compartilhadas e seus cargos."""

atrib_comp(atrib_gerais_LONPC_no_cor)

"""Atribuições compartilhadas por cargos."""

atrib_comp_cargos(atrib_gerais_LONPC_no_cor)

"""Atribuições exclusivas dos cargos."""

atrib_excl(atrib_gerais_LONPC_no_cor)

"""Abaixo a comparação entre os cargos de Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia."""

#Cargos a selecionar
lista_cargos_select = ['Perito Criminal', 'Perito Papiloscopista', 'Oficial Investigador de Polícia']

lista_exclusivas_compartilhadas_Ncargos(lista_cargos_select, atrib_gerais_LONPC_no_cor)

"""É possível verificar das listas de cargos LONPC sem correções entre todos os cargos, entre Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia:

1. O Perito Criminal possui 10 atribuições exclusivas (16,13%).
2. Perito Criminal e Perito Papiloscopista compartilham 2 atribuições (3,23%).
3. O Perito Papiloscopista possui 8 atribuições exclusivas (12,90%).
4. NÃO há atribuições compartilhadas entre Papiloscopista Policial e Oficial Investigador de Polícia (Zero – 0%).
5. O Oficial Investigador de Polícia possui 11 atribuições exclusivas (17,74%).
6. A tabela total com as 62 atribuições (100%).
7. A parte do Perito Criminal exclusiva, compartilhada entre Perito Criminal e Perito Papiloscopista, Perito Papiloscopista Exclusiva e compartilhada entre Perito Papiloscopista e Oficial Investigador de Polícia não se alterou em comparação com a situação atual sem correções. Somente as atribuições do Oficial Investigador de Polícia aumentaram.
8. Total de atribuições nas análises de atribuições exclusivas e compartilhadas: 31 (50,82%).

####1.1.3.2 Condensada

Abaixo a geração de tabelas condensadas.
"""

cargos_atrib_LONPC_nocor_condensed, cargos_atrib_LONPC_nocor_hist_redux = df_condensado_e_reducoes(cargos_atrib_LONPC_nocor)

cargos_atrib_LONPC_nocor_condensed

"""Tabela binária condensada colorida."""

titulo = "Tabela Binária - LONPC Condensada Sem Correção"
color_map = "RdGy"

heatmap_tabela_atrib(cargos_atrib_LONPC_nocor_condensed, titulo, color_map)

cargos_atrib_LONPC_nocor_hist_redux

"""Quantidade de colunas reduzidas."""

quant_colunas_reduzidas(cargos_atrib_LONPC_nocor, cargos_atrib_LONPC_nocor_condensed)

"""A simples adequação a LONPC gerou mais condensamento nas atribuições.

A seguir as atribuições condensadas por carreiras.
"""

atrib_cond_por_carreira(cargos_atrib_LONPC_nocor_condensed)

"""As simples condensações do editais não corrigidos geraram muitas atribuições condensadas exclusivas, o que pode faciliar na classificação. Contudo, deve-se aferir a validade dessas aglutinações e possíveis distorções desse modo simplista. Compartilhando de forma direta só há o Perito Criminal e o Médico Legista, o quais examinam locais de crime. Aparentemente, nem mesmo o grupo de apoio à perícia, o qual era conectado sem condensar, praticamente desaparece nesta análise.

###1.1.4 LONPC com correções

####1.1.4.1 Original

Foram utilizadas as correções propostas no item  1.1.2, mas aglutinando os cargos propostos no item 1.1.3.

Abaixo leitura da tabela binária.
"""

uploaded = files.upload()
cargos_atrib_LONPC_withcor = pd.read_csv('04 - Atrib LONPC With Cor.CSV', encoding='iso-8859-1', sep=';')

"""Verificação da leitura."""

#Verificando o arquivo
print(cargos_atrib_LONPC_withcor.to_string())

"""Remoção das atribuições comuns a todos os cargos."""

cargos_atrib_LONPC_withcor.loc[:, (cargos_atrib_LONPC_withcor == 1).all()]
cols_all_ones = cargos_atrib_LONPC_withcor.loc[:, (cargos_atrib_LONPC_withcor == 1).all()].columns.tolist()
atrib_gerais_LONPC_with_cor = cargos_atrib_LONPC_withcor.drop(cols_all_ones, axis=1)

"""Tabela binária colorida sem os atributos comuns."""

titulo = "Tabela Binária - LONPC Original Com Correção"
color_map = "RdBu"

heatmap_tabela_atrib(atrib_gerais_LONPC_with_cor, titulo, color_map)

"""Listagem de atribuições de cada carreira"""

atrib_por_carreira(atrib_gerais_LONPC_with_cor)

"""Atribuições compartilhadas e seus cargos."""

atrib_comp(atrib_gerais_LONPC_with_cor)

"""Atribuições exclusivas de cada cargo."""

atrib_excl(atrib_gerais_LONPC_with_cor)

"""Abaixo a comparação direta entre Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia."""

#Cargos a selecionar
lista_cargos_select = ['Perito Criminal', 'Perito Papiloscopista', 'Oficial Investigador de Polícia']

lista_exclusivas_compartilhadas_Ncargos(lista_cargos_select, atrib_gerais_LONPC_with_cor)

"""É possível verificar das listas de cargos LONPC com correções entre todos os cargos, entre Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia:

1. O Perito Criminal possui 6 atribuições exclusivas (9,84%).
2. Perito Criminal e Perito Papiloscopista compartilham 10 atribuições (16,39%).
3. O Perito Papiloscopista possui 3 atribuições exclusivas (4,92%).
4. NÃO há atribuições compartilhadas entre Papiloscopista Policial e Oficial Investigador de Polícia (Zero – 0%).
5. O Oficial Investigador de Polícia possui 11 atribuições exclusivas (18,03%).
6. A tabela total com as 61 atribuições (100%).
7. A parte do Perito Criminal exclusiva, commpartilhada entre Perito Criminal e Perito Papiloscopista, Perito Papiloscopista Exclusiva e compartilhada entre Perito Papiloscopista e Oficial Investigador de Polícia não se alterou em comparação com a situação Atual sem correções. Somente as atribuições do Oficial Investigador de Polícia aumentaram.
8. Total de atribuições nas análises de atribuições exclusivas e compartilhadas: 30 (49,18%).

####1.1.4.2 Condensada

Abaixo a geração de tabelas condensadas.
"""

cargos_atrib_LONPC_withcor_condensed, cargos_atrib_LONPC_withcor_hist_redux = df_condensado_e_reducoes(cargos_atrib_LONPC_withcor)

cargos_atrib_LONPC_withcor_condensed

"""Tabela binária condensada colorida."""

titulo = "Tabela Binária - LONPC Condensada Com Correção"
color_map = "RdBu"

heatmap_tabela_atrib(cargos_atrib_LONPC_withcor_condensed, titulo, color_map)

cargos_atrib_LONPC_withcor_hist_redux

"""Quantidade de colunas reduzidas."""

quant_colunas_reduzidas(cargos_atrib_LONPC_withcor, cargos_atrib_LONPC_withcor_condensed)

"""A redução foi similar a gerada similar a gerada na situação original.

A seguir as atribuições condensadas por carreiras.
"""

atrib_cond_por_carreira(cargos_atrib_LONPC_withcor_condensed)

"""Observando as atribuições compartilhadas, a lista se tornou praticamente a mesma gerada na situação das carreiras e atribuições atuais com correções.

###1.1.5 - Restruturação Proposta pela PCSP em 2024
Utilizando como base a restruturação apresentada pela PCSP em 2024, e colhendo as modificação tanto já sendo implementadas quanto aquelas propostas, pode-se ter uma ideia de como serão as modificações relativas ao que era antes da LONPC, e também confrontando a adequação a LONPC.
As correções são parecidas com as propostas anteriormente, com exceção de:
- Investigador de Polícia é renomedo para Oficial Investigador de Polícia. O Escrivão de Polícia é mantido a parte.
- Todas ausência pericial corretiva proposta para papiloscopista é mantida.
- Papiloscopista Policial e Auxiliar de Papiloscopista Policial são mesclados de forma simples no cargo de Papiloscopista Policial, sem atribuições periciais. Isso ocorre retirando todas as intersecções possíveis dos cargos periciais explícitos de Perito Criminal e Médico Legista, e criando três institutos novos: o Assessoramento Técnico Papiloscópico, o qual não seria perícia papiloscópica de local de crime, apesar da mesma essência; o Suporte a Desastres, o qual reduziria o papiloscopista a mero auxílio nessas situações; e a confeção de relatórios de assessoramento papiloscópico e exame papiloscópico, não periciais, meramente atividades policiais.
- As carreiras de apoio a investigação (Agente de Telecomunicações Policiais, Agente Policial e Carcereiro Policial) são mesclados no Agente de Polícia Judiciária. A priori, só foram atribuidas as funções de Oficial Investigador de Polícia.
- São mesclados Fotógrafo Técnico Pericial e Desenhista Técnico Pericial em Agente de Perícia Criminalística.
- São mesclados o Auxiliar de Necrópsia Policial e o Atendente de Necrotério Policial no Agente de Perícia Médico Legal.

####1.1.5.1 Original
"""

uploaded = files.upload()
cargos_atrib_restr = pd.read_csv('05 - Atrib Rest Rem Pericia.CSV', encoding='iso-8859-1', sep=';')

"""Verificação da leitura."""

#Verificando o arquivo
print(cargos_atrib_restr.to_string())

"""Remoção das atribuições comuns a todos os cargos."""

cargos_atrib_restr.loc[:, (cargos_atrib_restr == 1).all()]
cols_all_ones = cargos_atrib_restr.loc[:, (cargos_atrib_restr == 1).all()].columns.tolist()
atrib_gerais_restr = cargos_atrib_restr.drop(cols_all_ones, axis=1)

"""Tabela binária colorida sem os atributos comuns."""

titulo = "Tabela Binária - Restruturação Original Proposta PCSP 2024"
color_map = "RdYlBu"

heatmap_tabela_atrib(atrib_gerais_restr, titulo, color_map)

"""Listagem de atribuições de cada carreira"""

atrib_por_carreira(atrib_gerais_restr)

"""Atribuições compartilhadas e seus cargos."""

atrib_comp(atrib_gerais_restr)

"""Atribuições exclusivas de cada cargo."""

atrib_excl(atrib_gerais_restr)

"""Abaixo a comparação direta entre Perito Criminal, Papiloscopista (mesclado com Auxiliar de Papiloscopia Policial) e Oficial Investigador de Polícia."""

#Cargos a selecionar
lista_cargos_select = ['Perito Criminal', 'Papiloscopista Policial', 'Oficial Investigador de Polícia']

lista_exclusivas_compartilhadas_Ncargos(lista_cargos_select, atrib_gerais_restr)

"""É possível verificar das listas de cargos da restruturação proposta entre todos os cargos, entre Perito Criminal, Papiloscopista Policial e Oficial Investigador de Polícia:

1. O Perito Criminal possui 9 atribuições exclusivas (14,06%).
2. Perito Criminal e Papiloscopista Policial compartilham 1 atribuição (1,56%).
3. O Papiloscopista Policial possui 13 atribuições exclusivas (20,31%).
4. NÃO há atribuições compartilhadas entre Papiloscopista Policial e Oficial Investigador de Polícia (Zero – 0%).
5. O Oficial Investigador de Polícia não possuí atribuições exclusivas (Zero – 0%), já que compartilha todas com o Agente de Polícia Judiciária.
6. A tabela total com as 64 atribuições (100%) já que houve a criação do Assessoramento Técnico Papiloscópico, o Suporte a Desastres e a Edição de Relatórios de Assessoramento Técnico Papiloscópico e Relatórios de Exame Papiloscópico, todos não periciais.
7. A parte do Perito Criminal exclusiva e compartilhada entre  Papiloscopista Policial e Oficial Investigador de Polícia não se alterou em comparação com a situação Atual sem correções. Houve edução nas atrituições compartilhadas entre Perito Criminal e Papiloscopista Policial, aumento nas atribuições do Papiloscopista Policial e redução nas atribuições exclusivas do Oficial Investigador Policial.
8. Total de atribuições nas análises de atribuições exclusivas e compartilhadas: 23 (35,94%).

####1.1.5.2 Condensada

Abaixo a geração de tabelas condensadas.
"""

cargos_atrib_restr_condensed, cargos_atrib_restr_hist_redux = df_condensado_e_reducoes(cargos_atrib_restr)

cargos_atrib_restr_condensed

"""Tabela binária condensada colorida."""

titulo = "Tabela Binária - Restruturação Condensada Proposta PCSP"
color_map = "RdYlBu"

heatmap_tabela_atrib(cargos_atrib_restr_condensed, titulo, color_map)

cargos_atrib_restr_hist_redux

"""Quantidade de colunas reduzidas."""

quant_colunas_reduzidas(cargos_atrib_restr, cargos_atrib_restr_condensed)

"""A redução foi similar a gerada similar a gerada na situação atual corrigida.

A seguir as atribuições condensadas por carreiras.
"""

atrib_cond_por_carreira(cargos_atrib_restr_condensed)

"""Observando as atribuições exclusivas e compartilhadas, a lista se tornou uma apresentação das atribuições compartilhadas entre peritos explícitos (Perito Criminal e Médico Legista) e apoio a perícia (Agente de Perícia Criminalística e Agente de Perícia Médico Legal), com poucas exceções com o Papiloscopista Policial (identificação do cadáver latu sensu com o médico; e Suporte a desastres com o apoio a perícia criminal). Há o total compartilhamento entre atribuições do Oficial Investigador de Polícia e Agente de Polícia Judiciária.

###1.1.6 - Comentários Gerais
Com as listas exclusivas e compartilhadas, é possível verificar que em nenhum momento existem atribuições compartilhadas entre Papiloscopistas Policias e Investigadores de Polícia. A quantidade de atribuições compartilhadas varia de 2 a 10 entre Perito Criminal e Papiloscopistanas situações atuais e LONPC com e sem correções, já indicando atribuições compartilhadas entre esses cargos, como a presença de atribuições periciais para ambos. Todavia, há redução na restruturação proposta, afastando das questões periciais

Interessante notar que o Perito Criminal só atua com papiloscopia na fase externa, e realiza perícia de coleta na papiloscopia, e outras mais no local e com suas diferentes expertises. O Papiloscopista Policial atua em todo o ciclo da cadeia de custódia na papiloscopia, fase externa de coleta, e é o único Perito na identificação Papiloscópica a fazer perícia de fase interna na papiloscopia, a qual é o processamento (a perícia em si). Auxiliariares de papiloscopia auxiliam papiloscopistas na parte externa de coleta, e não possuem as condições necessárias para realizar perícia na parte externa, somente coleta auxiliar ao do papiloscopista. Com a alterações propostas, não haveria tanto perícia quanto prova pericial papiloscópica, abolindo tais na esfera pericial e policial do Estado de São Paulo.

Indicar que o papiloscopista realizaria assessoramento ao invés de perícia seria, no mínimo, duvidoso, haja vista enfrequecer uma prova sólida que é a mesma que o perito criminal trabalha. Ademais, os papiloscopistas trabalham com excelência, produzindo mais resultados que peritos pelo seu enfoque. Isto seria deturpar a ciência em um espaço geográfico ficcional de forma a funcionar como o humano deseja, e não a natureza, retirando o poder probatório dessa prova e a deixando mais frágil. Dessa forma, coloca-se em risco todas as operações, investigações e condenações por impressões digitais, além de criar ineficiência para a perícia, investigação, segurança pública e sociedade. Pode-se com isso criar desnecessidade da parte criminal do Instituto de Identificação, por criar retrabalho no ramo pericial da identificação. Além disso, cria-se castas entre peritos (explícitos e tácitos) e policias, acentuando diferenças sem motivos justos ou plausíveis.

#2 - Cálculo de Distâncias e HeatMaps das Similaridades
O cálculo de distância utiliza medidas relativas comparativas na tabela binária para verificar a proximidade com bases nos números e atributos. Desde que os dados estejam bem processados e sejam bem interpretados, é possível extrair algumas informações.

Em todas as análises, com exceção das feitas do item 5 em diante, haverá teste feitos com os dados originais e os condensados.

##2.1 Atual sem correção

####2.1.1 Original

Primeiramente, fez-se o mapeamento e processamento dos dados para ter-se a régua de distâncias relativas.
"""

def processamento_dados(df):
  # Colunas ignorando a coluna "Carreira"
  cols_all_ones = df.loc[:, (df == 1).all()].columns.tolist()
  df = df.drop(cols_all_ones, axis=1)
  mapping_atributos = df.columns[1:].tolist()

 #Mapeados e colocados em tabela como strings e numéricos
  global df_numeric
  df_numeric = df[mapping_atributos].astype(str)

  #Preenche as células com múltiplos valores com a mediana delas
  for j in df_numeric.index:
      for k in df_numeric.columns:
        if ',' in df_numeric.at[j,k]:
         df_numeric.at[j,k] = np.median([float(x) for x in df_numeric.at[j,k].split(',')])

  #Converte colunas que sejam string para numeric
  for k in df_numeric.columns:
    df_numeric[k] = pd.to_numeric(
        arg = df_numeric[k],
        errors = 'coerce')

  #Preenche as entradas de strings e valores NA com a mediana da coluna
  for k in df_numeric.columns:
    df_numeric[k] = df_numeric[k].fillna(
        value = np.nanmedian(
            a = df_numeric[k]))

  return df_numeric

processamento_dados(cargos_atrib_atual_nocor)

"""Abaixo são os cálculos das tabelas de distâncias. Essas distâncias são feitas pela medida de Jaccard, o qual utiliza a igualdade positiva (presença de atribuições compartilhadas - valor 1 na tabela binária) contra as desigualdades. Igualdades negativas (ausência de atribuição compartilhada - valor 0 na tabela binária) não são levadas em conta no cálculo.

![image.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAboAAABXCAYAAAByWoBtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACJCSURBVHhe7Z0L3BRVFcCvZqGphSiGD0xCU1MkTZEyxRKVFEoySUkT8oUIAfnKxExMQPFRKARBiiShZqCIj8wMxACTR+ELHzw0SyNIBSRUbJr/Yc4y33wzuzP77X7f7n7n//vd387O3pm9M/dx7j333HO38nycYRiGYdQoWwefhmEYhlGTmKAzDMMwahoTdIZhGEZNY4LOMAzDqGlM0BmGYRg1jQk6wzAMo6YxQWcYhmHUNCboDMMwjJrGBJ1hGIZR05igMwzDMGoaE3SGYRhGTWOCznDm7tQwjFrGBJ3hbr75Zjdq1KjgW3F8+OGH7n//+1/wrTYYOnSou+OOO4JvRqWzadMmd9RRR8lnsVCGa60cr1+/Xt4LdbS5YrsXGO66665z//3vf91PfvKT4Ew2li5d6g444AA3c+ZMd9JJJwVnmxaK9Ztvvumef/753PetttpKjmHXXXd1e+yxh/vEJz4h57feeus6vwPff/nLX7pzzz03OGNUMjTk22yzjXvvvffcxz72seBseigjJ554onvnnXfck08+KWWiEtiwYYObN2+eHEfLcYsWLdyee+4pAUhzNN0Iuh133FHeT6U8U6PjvzijmTNixAjvqquuCr5lw688Xp8+fegsebfffntwtunxe/Vely5dJF2FQufOnb3x48d7b7zxRnD1ZgYOHOj5gi74ZlQ65Dn56Qu64Ew2Zs+eLde3a9dOynWlMHz48DrlNV8YNGiQN2vWLM8flQZXe97atWvlt0p6psbGVJdGg7j//vvdpEmT5JgRVLGgLqLHGQ5++Qx+zc5HPvIR98c//lF69wceeKCcu/HGG90HH3yQC6i4HnzwQUn3+eef704++WS3bt06iWs0Lyh/qr7/17/+VXTZ47poWW6oKvSyyy5z77//vpsxY4Z8b9++vdu4caOc03LM8fe//33385//3B1zzDHO77hJXGMzJuiMois1lfiGG25wX/rSl+R7MYKOa0aPHu2+8pWvuP32289tv/32rk2bNu6QQw5xZ599tnvssceCmNlB2L377rvuueeek+/HHXecqLY08DuqKuYo4amnnnJ33323HEND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)

Fonte: https://pt.wikipedia.org/wiki/%C3%8Dndice_Jaccard
"""

def tabelas_distancia(df):
  #Calculando a tabela de distância com base na medição de Jaccard e nas tabelas de atribuições
  global dict_pdist
  dict_pdist = {}
  list_metric = ['jaccard'] #tipo de cálculo utilizado, nnão faz diferença entre igualdades positivas ou desigualdades. Igualdades negativas são ignoradas nos cálculos.
  for j in range(len(list_metric)):
    dict_pdist[j] = pdist(
        X = df_numeric,
        metric = str(list_metric[j]))

  #Ditribuição de Cálculos da Distância ao Quadrado - Jaccard
  global dict_pdist_squared
  dict_pdist_squared = squareform(X = dict_pdist[0])

  #Matrix de Similaridade + Carreiras na primeira coluna
  listaCarreira, column_value = [], []
  quant_carreiras = len(df)
  for i in range(0,quant_carreiras):
    column_value.append(df['Carreira'].values[i])
    listaCarreira = dict_pdist_squared[i]
  global tabelaDistCargos
  tabelaDistCargos = pd.DataFrame(dict_pdist_squared, columns=[column_value])
  tabelaDistCargos.insert(0, 'Carreira', column_value, allow_duplicates=False)

  #Cópia para trabalhar as correlações
  global tabelaCorrelation
  tabelaCorrelation = tabelaDistCargos
  tabelaCorrelation.reset_index(drop=True)

  #Ordem das variáveis retornadas abaixo
  #Utilização futura nas correlações
  #Ditribuição de Cálculos da Distância  -Jaccard
  #Ditribuição de Cálculos da Distância ao Quadrado  -Jaccard
  #Matrix de Similaridade
  #Cópia para trabalhar as correlações
  return dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_nocor)

"""Tabela de distâncias relativas."""

dict_pdist

"""Tabela de distâncias relativas elevada ao quadrado, para diminuir possíveis erros."""

dict_pdist_squared

"""Tabela da distribuição de distâncias entre cada cargo. Valores de zero indicam congruência perfeita (quando o mesmo cargos é comparada, o que pode ser observado na diagonal principal). Quanto mais próximo de zero e menos de um, mais assemelhados os cargos."""

tabelaDistCargos

"""Já é possível observar as similaridades os cargos em destaque:

Papiloscopista Policial x Perito Criminal: 0.913043.

Papiloscopista Policial x Investigador de Polícia: 1.000000.

Apesar de valores distantes de zero, o de Perito Criminal indica alguma similaridade, ao passo que o Investigador de Polícia nenhuma.

Abaixo cópia dessa tabela para utilização nos processamentos.
"""

tabelaCorrelation

"""Para melhorar a visualização, pode-se utilizar o HeatMap para ajudar a ver os valores que são correspondências perfeitas (0) e imperfeitas (1). Quanto mais o número próximo de zero, mais a similaridade. Lembrando que a diagonal central é a comparação de cargos idênticos."""

def heatmap_tabela_dist(tabelaCorrelation, titulo, color_map):
  tabelaCorrelation = tabelaCorrelation.set_index('Carreira')
  tabelaCorrelation = tabelaCorrelation.apply(pd.to_numeric, errors='coerce')

  fig, ax = plt.subplots(figsize=(18, 12))

  heatmap = sns.heatmap(tabelaCorrelation, annot=True, cbar=False)
  sns.heatmap(tabelaCorrelation, cmap = color_map, vmin = 0, vmax = 1,
              center = 0, linewidths=1, annot=True, square=True,
              linecolor='black', cbar=True)

  ax.set(xlabel=None)
  ax.set(ylabel=None)
  plt.title(titulo, fontsize=20)
  plt.show()

titulo = "Heat Map - Atual Original Sem Correção"
color_map = "BrBG"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Para facilitar as comparações e manter imagens menores, foi feita uma redução do gráfico para somente o Perito Criminal, Papiloscopista Policial e Investigador de Polícia."""

def tabela_correlation_selecionados(cargos_selecionados):
  global tabelaCorrelation_selected
  #copia colunas dos cargos selecionados da tabela de correlação
  tabelaCorrelation_selected = tabelaCorrelation[cargos_selecionados].copy()
  #seleciona linhas com valor zero, ou seja, somente dos cargos selecionados
  tabelaCorrelation_selected  = tabelaCorrelation_selected [tabelaCorrelation_selected.eq(0).any(axis=1)]
  #Removendo cargos com zero após o último (os cargos selecionados sempre são os três primeiros)
  tabelaCorrelation_selected.reset_index(drop=True, inplace=True)
  for index in tabelaCorrelation_selected.index:
    if index > 2:
      tabelaCorrelation_selected.drop(index, inplace=True)

  return tabelaCorrelation_selected

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Papiloscopista Policial', 'Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

def heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map):
  tabelaCorrelation_selected = tabelaCorrelation_selected.set_index('Carreira')
  tabelaCorrelation_selected = tabelaCorrelation_selected.apply(pd.to_numeric, errors='coerce')

  fig, ax = plt.subplots(figsize=(6, 4))

  heatmap = sns.heatmap(tabelaCorrelation_selected, annot=True, cbar=False)
  sns.heatmap(tabelaCorrelation_selected, cmap = color_map, vmin = 0, vmax = 1,
              center = 0, linewidths=1, annot=True, square=True,
              linecolor='black', cbar=True)

  ax.set(xlabel=None)
  ax.set(ylabel=None)
  plt.title(titulo, fontsize=10)
  plt.show()

titulo = "Heat Map - Atual Original Sem Correção Selecionados"
color_map = "BrBG"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""####2.1.2 Condensada

Processamento dos dados.
"""

processamento_dados(cargos_atrib_atual_nocor_condensed)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_nocor_condensed)

"""Tabela de distâncias calculadas."""

dict_pdist

"""Tabela de distâncias elevada ao quadrado."""

dict_pdist_squared

"""Tabela de Correlação advinda da tabela de distâncias relativas calculadas."""

tabelaCorrelation

"""Verificando a similaridade condensada entre os cargos em pauta, chegamos aos seguintes valores:

Papiloscopista Policial x Perito Criminal: 0.714286.

Papiloscopista Policial x Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial): 1.000000.

A similaridade com o Perito Criminal com Papiloscopista Policial cresceu com o condensamento de atribuições. Com Investigador de Polícia, a dissimilaridade continua total.

Verificando o HeatMap.
"""

titulo = "Heat Map - Atual Condensada Sem Correção"

color_map = "PRGn"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Papiloscopista Policial e Investigador de Polícia."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Papiloscopista Policial', 'Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - Atual Condensada Sem Correção Selecionados"
color_map = "PRGn"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""##2.2 Atual com correção

####2.2.1 Original

Processamento dos dados.
"""

processamento_dados(cargos_atrib_atual_withcor)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_withcor)

"""Tabela de distâncias calculadas."""

dict_pdist

"""Tabela de distâncias elevada ao quadrado."""

dict_pdist_squared

"""Tabela de Correlação advinda da tabela de distâncias relativas calculadas."""

tabelaCorrelation

"""Verificando a similaridade entre os cargos em pauta, chegamos aos seguintes valores:

Papiloscopista Policial x Perito Criminal: 0.696970.

Papiloscopista Policial x Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial): 1.000000.

A similaridade com o Perito Criminal cresceu ainda mais, ainda demonstrando a tendência pericial entre os dois cargos periciais vista sem as correções.

Verificando o HeatMap.
"""

titulo = "Heat Map - Atual Original Com Correção"

color_map = "PiYG"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Papiloscopista Policial e Investigador de Polícia (+ Agente de Telecomunicações + Agente Policial + Carcereiro Policial)."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Papiloscopista Policial', 'Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial)']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - Atual Original Com Correção Selecionados"
color_map = "PiYG"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""####2.2.2 Condensada

Processamento dos dados.
"""

processamento_dados(cargos_atrib_atual_withcor_condensed)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_withcor_condensed)

"""Tabelas de distâncias relativas calculadas."""

dict_pdist

"""Valores elevados ao quadrado para diminuir erros."""

dict_pdist_squared

"""Tabela de correlação, vinda da tabela de similaridade das distâncias calculadas entre os cargos."""

tabelaCorrelation

"""Verificando a similaridade condensada entre os cargos em pauta, chegamos aos seguintes valores:

Papiloscopista Policial x Perito Criminal: 0.615385.

Papiloscopista Policial x Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial): 1.000000.

A similaridade com o Perito Criminal com Papiloscopista Policial cresceu com o condensamento de atribuições e correções. Com o Investigador de Polícia, a dissimilaridade continua total.
"""

titulo = "Heat Map - Atual Condensada Com Correção"

color_map = "BrBG"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Papiloscopista Policial e Investigador de Polícia (+ Agente de Telecomunicações + Agente Policial + Carcereiro Policial)."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Papiloscopista Policial', 'Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial)']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - Atual Condensada Com Correção Selecionados"
color_map = "BrBG"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""##2.3 LONPC sem correção

####2.3.1 Original

Processamento dos dados.
"""

processamento_dados(cargos_atrib_LONPC_nocor)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_nocor)

"""Tabelas de distâncias relativas calculadas."""

dict_pdist

"""Valores elevados ao quadrado para diminuir erros."""

dict_pdist_squared

"""Tabela de correlação, vinda da tabela de similaridade das distâncias calculadas entre os cargos."""

tabelaCorrelation

"""Verificando os valores de similaridade entre os cargos específicos:

Perito Papiloscopista x Perito Criminal: 0.913043.

Perito Papiloscopista  x Oficial Investigador de Polícia: 1.000000.

 Mesmo valor na situação atual sem correções. Apesar de valores distantes de zero, o de Perito Criminal indica alguma similaridade, ao passo que o Oficial Investigador de Polícia nenhuma.

HeatMap.
"""

titulo = "Heat Map - LONPC Original Sem Correção"

color_map = "PuOr"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Perito Papiloscopista', 'Oficial Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - LONPC Original Sem Correção Selecionados"
color_map = "PuOr"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""####2.3.2 Condensada

Processamento dos dados.
"""

processamento_dados(cargos_atrib_LONPC_nocor_condensed)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_nocor_condensed)

"""Tabela de distância relativas."""

dict_pdist

"""Tabelas com valores elevados ao quadrado para redução dos erros."""

dict_pdist_squared

"""Tabela de Correlação, advinda da tabela de distâncias calculadas entre cargos."""

tabelaCorrelation

"""Verificando a similaridade entre os cargos em pauta, chegamos aos seguintes valores:

Perito Papiloscopista x Perito Criminal: 0.833333.

Perito Papiloscopista Policial x Oficial Investigador de Polícia: 1.000000.

A dissimilaridade com o Oficial Investigador de Polícia e o Perito Papiloscopista continua. A similaridade com o Perito Criminal cresceu em relação ao original não condensado, ainda demonstrando a tendência pericial entre os dois cargos periciais vista sem as correções.

HeatMap gerado.
"""

titulo = "Heat Map - LONPC Condensado Sem Correção"

color_map = "RdGy"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Perito Papiloscopista', 'Oficial Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - LONPC Condensada Sem Correção Selecionados"
color_map = "RdGy"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""##2.4 LONPC com correção

####2.4.1 Original

Processamento dos dados.
"""

processamento_dados(cargos_atrib_LONPC_withcor)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_withcor)

"""Tabela de distância relativas."""

dict_pdist

"""Tabelas com valores elevados ao quadrado para redução dos erros."""

dict_pdist_squared

"""Tabela de Correlação, advinda da tabela de distâncias calculadas entre cargos."""

tabelaCorrelation

"""Verificando a similaridade entre os cargos em pauta, chegamos aos seguintes valores:

Perito Papiloscopista x Perito Criminal: 0.687500.

Perito Papiloscopista Policial x Oficial Investigador de Polícia: 1.000000.

Dissimilaridade entre o Oficial Investigador de Polícia e o Perito papiloscopista continua máxima. A similaridade com o Perito Criminal cresceu ainda mais em relação a não corrigido, ainda demonstrando a tendência pericial entre os dois cargos periciais.

HeatMap gerado.
"""

titulo = "Heat Map - LONPC Original Com Correção"

color_map = "RdBu"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Perito Papiloscopista', 'Oficial Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - LONPC Original Com Correção Selecionados"
color_map = "RdBu"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""####2.4.2 Condensada

Processamento dos dados.
"""

processamento_dados(cargos_atrib_LONPC_withcor_condensed)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_withcor_condensed)

"""Tabela de distância relativas."""

dict_pdist

"""Tabelas com valores elevados ao quadrado para redução dos erros."""

dict_pdist_squared

"""Tabela de Correlação, advinda da tabela de distâncias calculadas entre cargos."""

tabelaCorrelation

"""Verificando a similaridade entre os cargos em pauta, chegamos aos seguintes valores:

Perito Papiloscopista x Perito Criminal: 0.600000	.

Perito Papiloscopista Policial x Oficial Investigador de Polícia: 1.000000.

A dissimilaridade com o Oficial Investigador de Polícia e o Perito Papiloscopista continua. A similaridade com o Perito Criminal cresceu em relação ao original não condensado e original, ainda demonstrando a tendência pericial entre os dois cargos periciais vista sem as correções. Foi o melhor valor obtido entre os dois cargos.

HeatMap gerado.
"""

titulo = "Heat Map - LONPC Condensado Com Correção"

color_map = "RdYlBu"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Perito Papiloscopista e Oficial Investigador de Polícia."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Perito Papiloscopista', 'Oficial Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - LONPC Condensada Com Correção Selecionados"
color_map = "RdYlBu"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""##2.5 Reestruturação Proposta pela PCSP 2024

####2.5.1 Original

Processamento dos dados.
"""

processamento_dados(cargos_atrib_restr)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_restr)

"""Tabela de distância relativas."""

dict_pdist

"""Tabelas com valores elevados ao quadrado para redução dos erros."""

dict_pdist_squared

"""Tabela de Correlação, advinda da tabela de distâncias calculadas entre cargos."""

tabelaCorrelation

"""Verificando a similaridade entre os cargos em pauta, chegamos aos seguintes valores:

Perito Crimnal x Papiloscopista Policial: 0.972222.

Papiloscopista Policial x Oficial Investigador de Polícia: 1.000000.

Dissimilaridade entre o Oficial Investigador de Polícia e o Perito papiloscopista continua máxima. A similaridade com o Perito Criminal diminui, tendendo a chegar a 1 (um), criando maior dissimilaridade.

HeatMap gerado.
"""

titulo = "Heat Map - Restruturação PCSP 2024 Original"

color_map = "RdYlBu"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Papiloscopista Policial e Oficial Investigador de Polícia."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Papiloscopista Policial', 'Oficial Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - Restruturação PCSP 2024 Original Selecionados"
color_map = "RdYlBu"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""####2.5.2 Condensada

Processamento dos dados.
"""

processamento_dados(cargos_atrib_restr_condensed)

dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_restr_condensed)

"""Tabela de distância relativas."""

dict_pdist

"""Tabelas com valores elevados ao quadrado para redução dos erros."""

dict_pdist_squared

"""Tabela de Correlação, advinda da tabela de distâncias calculadas entre cargos."""

tabelaCorrelation

"""Verificando a similaridade entre os cargos em pauta, chegamos aos seguintes valores:

Perito Criminal x Papiloscopista Policial: 0.900000.

Papiloscopista Policial x Oficial Investigador de Polícia: 1.000000.

Dissimilaridade entre o Oficial Investigador de Polícia e o Papiloscopista Policial continua máxima. A similaridade com o Perito Criminal diminui menos, ainda tendendo a chegar a 1 (um), criando maior dissimilaridade.

HeatMap gerado.
"""

titulo = "Heat Map - Restruturação PCSP 2024 Condensado"

color_map = "RdYlGn"

heatmap_tabela_dist(tabelaCorrelation, titulo, color_map)

"""Redimensionagem para somente o Perito Criminal, Papiloscopista Policial e Oficial Investigador de Polícia."""

carreiras_selecionadas = ['Carreira','Perito Criminal', 'Papiloscopista Policial', 'Oficial Investigador de Polícia']

tabela_correlation_selecionados(carreiras_selecionadas)

titulo = "Heat Map - Restruturação PCSP 2024 Condensada Selecionados"
color_map = "RdYlBu"

heatmap_tabela_dist_selecionados(tabelaCorrelation_selected, titulo, color_map)

"""##2.6 Comentários Gerais
Em nenhuma situação proposta houve similaridade entre Investigadores de Polícia e Papiloscopistas Policiais (valor sempre 1.0, de total dissimilaridade). A situação entre Perito Criminal e Papiloscopista Policial variou de 0.6 a 0.913043 nas situações atuais e LONPC com e sem correções, indicando dissimilaridade, mas ainda menor do que com o Investigador de Polícia. Poucos os valores eram menores que 0.5 na totalidade dos cálculos, com o menor encontrado sendo 0.43 (Papiloscopista Policial com Auxiliar de Papiloscopista Policial).

Tal fato faz sentido, já que muita similaridade indicaria talvez o mesmo cargo com poucas diferenças. Ainda que dissimilar em certo grau, esse os valores entre Papiloscopistas Policiais e Peritos indicam similaridade de atribuições.

Valores mais baixos com Auxiliar de Papiloscopista são esperados, já que Papiloscopista Policiais realizam tudo que Auxiliares de Papiloscopista realizam, e estes também estão afeitos a perícia, ainda que em apoio.

Ao checar a proposta de reestruturação da PCSP, os valores aumentam, indicando uma movimento para a dissimilaridade entre Papiloscopista Policiais e Peritos Criminais. Não houve total dissimilaridade, mas outras táticas que poderiam indicar a tendencia de redução pericial para ir ao Investigador de Polícia seria retirar mais ainda as poucas atribuições que restariam e criar atribuições comuns a esses cargos, com exceção dos periciais e de apoio à perícia.

#3 - Régua de Gower e Representação Linear
A biblioteca Gower permite ordenar os cargos a partir das distâncias relativas, criando uma tabela e uma imagem linear de separação dos cargos. No geral, a régua de Gower e a representação linear, de todos os tipos de visualizações, foram os que apresentaram resultados mais pobres, apesar de oferecerem algumas intrepretações interessantes ao caso.

##3.1 Atual sem correção

Organização da régua, levando em consideração os valores de distância. O cargo de Delegado de Polícia ficou na posição zero, por sempre ser o mais dissimilar entre todos os cargos, e serviu de "base" comparativa para os outros cargos.

####3.1.1 Original
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_atual_nocor)

"""Com a régua, é feita uma tabela para melhor visualização."""

#arrumar ordem dos cargos no mapeamento
def tabela_gower(df):
  #Jaccard'd Similarity Actual No Corrections Scale Panda Matrix
  global tabelaReguaGower
  tabelaReguaGower = pd.DataFrame(regua_gower)
  tabelaReguaGower.sort_values(by=['index'], inplace=True)

  #Mapeando as Carreiras
  mapping_carreira = {}
  for i, carreira in enumerate(df['Carreira']):
     mapping_carreira[carreira] = i
  inversão_mapeamento = {v: k for k, v in mapping_carreira.items()}

  tabelaReguaGower['index'] = tabelaReguaGower['index'].map(inversão_mapeamento).fillna(df['Carreira'])
  tabelaReguaGower.rename(columns={'index': "Carreira", 'values': "Distância Relativa (Jaccard)"}, inplace=True)
  tabelaReguaGower.reset_index(inplace=True, drop=True)
  tabelaReguaGower.sort_values("Distância Relativa (Jaccard)", inplace=True)
  #tabelaReguaGower.insert(1, "Iniciais", tabelaReguaGower['Carreira'].apply(lambda x: "".join([word[0] for word in x.split() if word[0].isupper()])))

  return tabelaReguaGower

tabela_gower(cargos_atrib_atual_nocor)

"""Já é possível ver os seguintes resultados:
1. Delegado está no começo da lista com zero (Delegados).
2. Agente de Telecomunicações Policial, Agente policial e Carcereiro ocupam uma segunda posição (apoio a investigação)
3. Escrivão ocupa a parte de investigação após os cargos de apoio a investigação.
4. Auxiliar de Papiloscopista Policial e Auxiliar de Necrópsia Policial ocupam mesma posição após os anteriores (apoio a perícia).
5. Fotógrafo Técnico Pericial, Desenhista Ténico Pericial e Atendente de Necrotério ocupam o mesmo lugar (apoio a perícia).
6. Investigador de Polícia e Médico Legista ocupam o mesmo local, o que indica que a quantidade de atribuições pode estar causando um desvio da posição do Investigador de Polícia. (apoio a perícia e investigação).
7. O Papiloscopista Policial segue com o Perito Criminal em seguida, ocupando a ponta de Perícia.

Ao observar a Tabela de Gower, levando em consideração as distâncias relativas calculadas com a métrica de Jaccard, pode-se observar os valores de distância entre os cargos em pauta. Deve-se atentar que os valores estão em relação ao ponto zero (Delegado de Polícia).

Investigador de Polícia: 0.164384.

Papiloscopista Policial: 0.205479.

Perito Criminal: 0.273973.

O gráfico de representação linear abaixo pode indicar se, apesar dos valores entre Investigador de Polícia e Papiloscopista Policial serem menores em comparação com o Papiloscopista Policial e o Perito Criminal, se estes estariam em um mesmo grupo.

Criando a Representação Linear.
"""

def representacao_linear(titulo):

  global repr_linear
  repr_linear = tabelaReguaGower.copy()
  repr_linear['carreira'] = 0

  #Dropando colunas não numéricas antes do clustering
  numeric_repr_linear = repr_linear.select_dtypes(include=['number'])

  #Métrica Euclideana (comum), linkage do tipo single (agrupa os mais próximos)
  grupos = AgglomerativeClustering(n_clusters=n_grupos, metric='euclidean', linkage='single')

  #Cluster com Jaccard's Agglomerative Clustering
  global dist_linear
  dist_linear = grupos.fit_predict(numeric_repr_linear)

  #Criando a régua automatizada diretamente da Tabela de Distância dos cargos atuais com Jaccard sem correções
  position = ['top', 'bottom']
  fig, eixo = plt.subplots()
  fs = 6

  plt.scatter(tabelaReguaGower["Distância Relativa (Jaccard)"],tabelaReguaGower["Carreira"],c=grupos.labels_, cmap='rainbow')
  plt.xlabel("Distância Relativa (Jaccard)")
  plt.ylabel('Carreira')

  plt.title(titulo)
  plt.figure().set_figwidth(60)
  plt.show()

  return repr_linear, dist_linear

n_grupos = 5 #Delegados, investigação, apoio investigação, perícia e apoio a perícia

titulo = 'Distância Relativa - Cargos Atuais Original Sem correções'

repr_linear, dist_linear = representacao_linear(titulo)

dist_linear

"""A separação linear permite verificar os grupos os quais cada cargo estarem de forma colorida. Verificando o gráfico acima, temos:
1. Delegado (laranja): somente Delegado de Polícia, na primeira posição.
2. Apoio a Investivação (azul): Agente de Telecomunicações Policial, Agente Policial e Carcereiro Policia.
3. Investigação e Apoio a Perícia: este foi o grupo (roxo) o qual mais ficou bagunçado, devendo ser divido em dois e retirando o último cargo, com:
  - Escrivão de Polícia (Investigação)
  - Auxiliar de Papiloscopia Policial, Auxiliar de Necrópsia Policial, Fotógrafo Técnico Policial, Desenhista Técnico Policial e Atendente de Necrotério (Apoio à Perícia)
  - Investigador (Investigação, claramente fora da posição devido quantidade de atribuições)
  - Médico Legista (Perícia, ficou neste grupo devido os valores próximos dos outros)
4. Perícias: os dois últimos cargos são de perícias, com o Papiloscopista Policial (vermelho) e Perito Criminal (Verde).

####3.1.2 Condensada

Primeiro, cálculo da régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_atual_nocor_condensed)

"""Criação da tabela para melhor visualização."""

tabela_gower(cargos_atrib_atual_nocor_condensed)

"""Observando a tabela gerada com as correções:
1. Delegado está no começo da lista com zero (Delegados).
2. Agente de Telecomunicações Policial, Agente Policial e Carcereiro vem em seguida no grupo de apoio à investigação.
3. Escrivão de Polícia e Atendente de Necrotério Policial seguem com um valor em um grupo misto de investigação e apoio à perícia.
4. O Investigador de Polícia e Auxiliar de Necrópsia Policial aparecem com o mesmo valor, em mescla do grupo anterior.
5. Papiloscopista e Auxiliar de Papiloscopia aparecem com mesmo valor, em um grupo de papiloscopia, conjuntamente com o Fotógrafo Técnico Pericial.
6. Médico Legista é o próximo, seguido de Desenhista Técnico Pericial e por último o Perito Criminal.

Vendo a Tabela de Gower Condensada, levando em consideração as distâncias relativas calculadas com a métrica de Jaccard, pode-se observar os valores de distância entre os cargos em pauta. Deve-se atentar que os valores estão em relação ao ponto zero (Delegado de Polícia).

Investigador de Polícia : 0.210526.

Papiloscopista Policial: 0.263158.

Perito Criminal: 0.421053.

No geral, a régua ficou desorganizada, misturando boa parte dos grupos. Investigador de Policial tem valor mais próximo do Papiloscopista Policial, e o Perito Criminal atingiu valor extremo ao visto em outros casos. Contudo, sempre se deve observar os valores de Gower no prista de grupos e outras informações, como a representação linear.
"""

n_grupos = 5 #Delegados, investigação, perícia, apoio a perícia e apoio a investigação.

titulo = 'Distância Relativa - Cargos Atuais Condensados sem correções'

repr_linear, dist_linear = representacao_linear(titulo)

"""A separação linear permite verificar os grupos os quais cada cargo estarem de forma colorida. Verificando o gráfico acima, temos:
1. Delegado (laranja): somente Delegado de Polícia, na primeira posição.
2. Apoio à Investigação, Investigação e Apoio à Medicina Legal (roxo): este grupo mesclou Agente de Telecomunicações Policial, Agente Policial, Carcereiro Policial, Escrivão de Polícia, Atendente de Necrotério Policial, Investigador de Polícia e Auxiliar de Necrópsia Policial. Este grupo foi o que mais se tornou desorganizado.
3. Papiloscopia, fotografia e Medicina Legal (azul): grupo contendo Papiloscopista Policial, Auxiliar de Papiloscopista Policial, Fotógrado Técnico Pericial e Médico Legista. Também houve desordem na organização deste grupo
4. Desenhista Técnico Pericial ficou isolado em um grupo (vermelho).
5. Perito Criminal no extremo em verde.

##3.2 Atual com correção

####3.2.1 Original

Primeiro, cálculo da régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_atual_withcor)

"""Criação da tabela para melhor visualização."""

tabela_gower(cargos_atrib_atual_withcor)

"""Observando a tabela gerada com as correções:
1. Delegado está no começo da lista com zero (Delegados).
2. Escrivão de Polícia segue com o grupo investigação.
3. O Fotógrafo Técnico Pericial e o Auxiliar de Necrópsia Policial seguem em um pequeno grupo de apoio a investigação.
4. O Investigador de Polícia, aglutinado com Agente de Telecomunicações Policial, Agente Policial e Carcereiro Policial, vem em terceiro com a investigação. O apoio a investigação neste caso deixa de existir. Mais uma vez, ele parece deslocado na régua.
5. Desenhista Técnico Pericial, Atendente de Necrotério Policial e Auxiliar de Papiloscopista Policial vem em um segundo grupo do apoio a perícia.
6. Todos os cargos periciais estão na ponta oposta, com os cargos na ordem de Médico Legista, Perito Criminal e Papiloscopista Policial.

Vendo a Tabela de Gower, levando em consideração as distâncias relativas calculadas com a métrica de Jaccard, pode-se observar os valores de distância entre os cargos em pauta. Deve-se atentar que os valores estão em relação ao ponto zero (Delegado de Polícia).

Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial): 0.178082.


Perito Criminal: 0.356164


Papiloscopista Policial: 0.369863.


Com as correções, o Papiloscopista Policial passa a ficar mais próximo do perito criminal em relação ao Investigador que Polícia, que aparentemente parece deslocado dentro do grupo de apoio a investigação. A representação linear pode auxiliar verificar a similaridade dos cargos.
"""

n_grupos = 4 #Delegados, investigação, perícia e apoio a perícia. Apoio a investigação é suprimido devido a aglutinação de cargos.

titulo = 'Distância Relativa - Cargos Atuais Original Com correções'

repr_linear, dist_linear = representacao_linear(titulo)

"""Observando a representação linear dos cargos atuais corrigidos, podemos verificar:
1. Delegados seguem na bases sozinhos em vermelho, no grupo delegados.
2. Em azul há uma mistura do investigação com o apoio à perícia, com os cargos, nesta ordem, Escrivão de Polícia, Fotógrafo Técnico Pericial, Auxiliar de Necrópsia Policial, Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial), Desenhista Técnico Pericial e Atendente de Necrotério Policial. Aparentemente o Investigador continua deslocado na régua.
3. Em amarelo está o Auxiliar de Papiloscopista Policial, que deveria está no grupo de apoio à perícia.
4. Por fim, em roxo, grupo de perícia, com o Médico Legista, Perito Criminal e Papiloscopista Policial.

####3.2.2 Condensada

Iniciando com a régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_atual_withcor_condensed)

"""Criando a tabela para melhor visualizar."""

tabela_gower(cargos_atrib_atual_withcor_condensed)

"""Observando a tabela gerada com as correções e condensada:
1. Delegado está no começo da lista com zero (Delegados).
2. Escrivão de Polícia vem em segundo e depois o Investigador de Polícia (Investigação).
3. Um grande grupo de apoio a perícia segue, com Fotógrafo Técnico Pericial, Atendente de Necrotério Policial, Auxiliar de Necrópsia Policial, Auxiliar de Papiloscopista Policial e Desenhista Técnico Policial.
4. Por último, o grupo com os peritos, sendo o Médico Legista, o Perito Criminal e o Papiloscopista.

Vendo a Tabela de Gower Condensada, levando em consideração as distâncias relativas calculadas com a métrica de Jaccard, pode-se observar os valores de distância entre os cargos em pauta. Deve-se atentar que os valores estão em relação ao ponto zero (Delegado de Polícia).

Investigador de Polícia (+ Agente de Telecomunicações + Agente Policial + Carcereiro) : 0.208333.

Perito Criminal: 0.458333.

Papiloscopista Policial: 0.458333.

A regua se tornou bastante organizada, juntos cargos similares. Não só o Papiloscopista Policial se distanciou do Investigador de Polícia, como obteve o mesmo valor do Perito Criminal. Para melhor aferição dos dados, deve-se checar a representação linear.
"""

n_grupos = 4 #Delegados, investigação, perícia e apoio a perícia.

titulo = 'Distância Relativa - Atual Condensada Com correções'

repr_linear, dist_linear = representacao_linear(titulo)

"""A separação linear permite verificar os grupos os quais cada cargo estarem de forma colorida. Verificando o gráfico acima, temos:
1. Delegado (vermelho): somente Delegado de Polícia, na primeira posição.
2. Investigação e apoio à perícias (roxo): ainda que mesclados devido valores próximos, há ordem entre os cargos, com Escrivão de Polícia, Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente POlicial + Carcereiro Policial), Fotógrafo Técnico Pericial, Atendente de Necrotério Policial, Auxiliar de Necrópsia Policial, Auxiliar de Papiloscopista Policial e Desenhista Técnico Pericial.
3. Médico Legista fica individualizado em um grupo azul de perícia médica.
4. Perito Criminal e Papiloscopista Policial assumem a extremidade com as perícias restante em amarelo.

##3.3 LONPC sem correção

####3.3.1 Original

Iniciando com a régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_LONPC_nocor)

"""Criando a tabela para melhor visualizar."""

tabela_gower(cargos_atrib_LONPC_nocor)

"""Ao seguir a LONPC com as atribuições sem correções, é possível verificar:
1. Delegado está no começo da lista com zero (Delegados).
2. Agente de Perícia Papiloscópica vem em segundo.
3. Médico Legista em terceiro.
4. Agente de Perícia Criminalística segue.
5. Perito Papiloscopista vem em quarto.
6. Oficial Investigador de Polícia e Agente de Perícia Médico Legal seguem com o mesmo valor.
7. Por último, Perito Criminal.

Toda a régua apresenta desorganização nos grupos, o que indica que a mera passagem sem correções das atribuições poderia indicar cargos menos especialistas e mais generalistas, o que pode ser um perigo a carreiras tanto periciais quanto investigativas.

Observando a tabela, considerando o ponto base o Delegado de Polícia, as posições dos cargos em pauta ficam.

Perito Papiloscopista: 0.205479.

Oficial Investigador de Polícia: 0.219178.

Perito Criminal: 0.273973.


O Perito Papiloscopista fica mais basal em comparação ao Oficial Investigador de Polícia e ao Perito, além de mais próximo em termo numéricos brutos. Deve-se observar a representação linear para se ter uma ideia dos possíveis grupos.
"""

n_grupos = 4 #Delegados, investigação, perícia e apoio a perícia.

titulo = 'Distância Relativa - LONPC Original Sem correções'

repr_linear, dist_linear = representacao_linear(titulo)

"""Observando a representação gerada pelo LONPC, podemos verificar:
1. Em vermelho, grupo do Delegado de Polícia, na base do gráfico.
2. Um segundo grupo em roxo com o Agente de Perícia Papiloscópica, Médico Legista e Agente de Perícia Criminalística.
3. Em azul, Perito Papiloscopista, Oficial Investigador de Polícia e Agente de Perícia Médico Legal.
4. Por fim, sozinho, em amarelo, Perito Criminal.

A representação pouco auxílio na separação dos grupos, o que indica desorganização no modelo gerado.

####3.3.2 Condensada

Início com a régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_LONPC_nocor_condensed)

"""Gerando a tabela para melhor visualizar."""

tabela_gower(cargos_atrib_LONPC_withcor)

"""Observando a tabela gerada com as correções e condensada:
1. Delegado está no começo da lista com zero (Delegados).
2. Oficial Investigador de Polícia aparece em segundo no investigação.
3. Há grupo Perito Papiloscopista, Agente de Perícia Papiloscópica, Agente de Perícia Criminalística e Agente de Perícia Médico Legal, indicando um grupo de apoio a perícia com a perícia papiloscopica junto.
4. Médico Legista e Perito Criminal surgem distantes, com o resto das perícias.

Vendo a Tabela de Gower Condensada, levando em consideração as distâncias relativas calculadas com a métrica de Jaccard, pode-se observar os valores de distância entre os cargos em pauta. Deve-se atentar que os valores estão em relação ao ponto zero (Delegado de Polícia).

Oficial Investigador de Polícia : 0.230769.

Perito Papiloscopista: 0.307692.

Perito Criminal: 0.538462.

A régua está relativamente organizada com menos cargos e condensada, mas a falta de correções confunde a posição do Perito Papiloscopista. Isto pode ensejar que a mera aglutinação de similares sem se atentar a correções necessárias no distanciamento das perícias que já ocorre, evidenciando um tratamento histórico dado aos Peritos Papiloscopista e sendo relativamente evidenciado no números calculados. Como de praxe, deve-se verificar também a representação linear.
"""

n_grupos = 4 #Delegados, investigação, perícia e apoio a perícia.

titulo = 'Distância Relativa - LONPC Condensada Sem correções'

repr_linear, dist_linear = representacao_linear(titulo)

"""A separação linear permite verificar os grupos os quais cada cargo estarem de forma colorida. Verificando o gráfico acima, temos:
1. Delegado (laranja): somente Delegado de Polícia, na primeira posição.
2. Perícia Papiloscópica e Apoio à Perícias (roxo): o Periro Papiloscopista, seguido do Agente de Perícia Papiloscópica, Agente de Perícia Criminalística e Agente de Perícia Médico legal ficam em um grupo.
3. O Médico Legista em azul com perícias médico legais.
4. Perito Criminal na ponta com perícias criminalística em amarelo.

Com exceção do Perito Papiloscopista, há certa lógica na organização da representação.

##3.4 LONPC com correção

####3.4.1 Original

Início com a régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_LONPC_withcor)

"""Gerando a tabela para melhor visualizar."""

tabela_gower(cargos_atrib_LONPC_withcor)

"""Ao seguir a LONPC com as atribuições com correções, é possível verificar:
1. Delegado está no começo da lista com zero (Delegados).
2. Agente de Perícia Criminalística vem em segundo.
3. Oficial Investigador de Polícia vem em terceiro.
4. Agente de Perícia Papiloscópica e Agente de Perícia Médico Legal vem na ordem citada, um grupo de apoio à perícia.
5. O grupo de perícia aparece por último, com o Médico legista, Perito Criminal e Perito Papiloscopista.

Com exceção do agente de Perícia Criminalística e/ou Oficial Investigador de Polícia, todos aparentemente seguem uma lógica de posição e grupamento.

Observando a tabela, considerando o ponto base o Delegado de Polícia, as posições dos cargos em pauta ficam.

Oficial Investigador de Polícia: 0.219178.

Perito Criminal: 0.356164.

Perito Papiloscopista: 0.356164.


Não só o Oficial Investigador de Polícia fica mais basal como o Perito Criminal e o Perito Papiloscopista possuem a mesma posição. Como de praxe, observar a divisão proposta da representação linear.
"""

n_grupos = 4 #Delegados, investigação, perícia e apoio a perícia.

titulo = 'Distância Relativa - LONPC, Original com correções'

repr_linear, dist_linear = representacao_linear(titulo)

"""Observando a representação linear proposta:
1. Delegado de Polícia está na base separado, em vermelho.
2. Há um grupo de apoio à perícia com Agente de Perícia Criminalística, Oficial Investigador de Polícia (possivelmente deslocado), Agente de Perícia Papiloscópica e Agente de Perícia Médico legal, em roxo.
3. Um primeiro grupo de perícia, com o Médico Legista.
4. Um segundo grupo de perícia, com Perito Criminal e Perito Papiloscopista.

Neste situação, excetuando a posição do Oficial Investigador de Polícia, há consonância nas posições apresentadas.

####3.4.2 Condensada

Início com a régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_LONPC_withcor_condensed)

"""Gerando a tabela para melhor visualizar."""

tabela_gower(cargos_atrib_LONPC_withcor_condensed)

"""Observando a tabela gerada com as correções e condensada:
1. Delegado está no começo da lista com zero (Delegados).
2. Oficial Investigador de Polícia aparece em segundo no investigação.
3. Há o grupo de  Agente de Perícia Papiloscópica, Agente de Perícia Criminalística e Agente de Perícia Médico Legal, indicando um grupo de apoio a perícia como esperado.
4. Médico Legista aparecer, seguido do Perito Criminal e Perito Papiloscopista, formando o grupo das perícias.

Vendo a Tabela de Gower Condensada, levando em consideração as distâncias relativas calculadas com a métrica de Jaccard, pode-se observar os valores de distância entre os cargos em pauta. Deve-se atentar que os valores estão em relação ao ponto zero (Delegado de Polícia).

Oficial Investigador de Polícia : 0.176471.

Perito Criminal: 0.529412.

Perito Papiloscopista: 0.529412.

A régua está bem organizada, apresentando boa classificação e distanciamento no que poderia ser esperado dos grupos. Perito Criminal e Perito Papiloscopista assumem mesmos valores.
"""

n_grupos = 4 #Delegados, investigação, perícia e apoio a perícia.

titulo = 'Distância Relativa - LONPC, Condensada com correções'

repr_linear, dist_linear = representacao_linear(titulo)

"""O gráfico de separação linear indica os seguintes grupos:

1 - Delegados (amarelo): sozinhos na base:

2 - Oficial de Investigação PoliciaL (vermelho): cargo único de investigação, também basal.

3 - Apoio à perícia (azul): os Agentes de Perícia Papiloscópica, Criminalística e Médico legal estão juntos.

4 - Peritos (roxo): Médico Legista, Perito Criminal e Papiloscopistas estão no topo, juntos, como perito.

Tal gráfico se demonstrou como um bom divisor, e uma forma de organização tanto em atribuições como em similaridade para os cargos.

##3.5 Reestruturação proposta pela PCSP 2024

####3.5.1 Original

Início com a régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_restr)

"""Gerando a tabela para melhor visualizar."""

tabela_gower(cargos_atrib_restr)

"""Ao seguir a reestruturação, é possível verificar:
1. Delegado está no começo da lista com zero (Delegados).
2. O Escrivão de Polícia segue em segundo.
3. O Oficial Investigador de Polícia e o Agente de Polícia Judiciária são os próximos, com o mesmo valor devido terem idênticas as atribuições.
4. O Agente de Perícia Criminalística segue em próximo.
5. O Agente de Perícia Médico Legal vem depois,
6. O Papiloscopista aparece em penúltimo lugar.
7. O Médico Legista vem em penúltimo.
8. Por fim, o Perito Criminal ocupa o extremo oposto.

Curiosamente, essa régua apresenta uma lógica de disposição, com Delegados no início, Investigação (Escrivão de Polícia e Oficial Investigador de Polícia), apoio à investigação (Agente de Polícia Judiciária), apoio à perícia (Agente de Perícia Criminalística e Agente de Perícia Médico Legal), Papiloscopista Policial e peritos criminais (Médico Legista e Perito Criminal).

Observando a tabela, considerando o ponto base o Delegado de Polícia, as posições dos cargos em pauta ficam.

Oficial Investigador de Polícia: 0.171053.

Papiloscopista Policial: 0.276316.

Perito Criminal: 0.342105.


A distância entre Oficial Investigador de Polícia e Papiloscopista é relativamente grande, com muitos cargos entre eles. Há distanciamento relativamente menor entre Papiloscopista Policial e Perito Crimnal. Como de praxe, observar a divisão proposta da representação linear. Voltamos a ter 5 grupos nesta representação: Delegados, Investigação, Apoio à Investigação, Apoio à Perícia e Perícia.
"""

n_grupos = 5 #Delegados, investigação, apoio à investigação, perícia e apoio a perícia.

titulo = 'Distância Relativa - Restruturação PCSP 2024 Original'

repr_linear, dist_linear = representacao_linear(titulo)

"""Observando a representação linear proposta:
1. Delegado de Polícia está na base separado, em vermelho.
2. Um segundo grupo em vermelho é criado com o Escrivão de Polícia, de Cartório.
3. Um terceiro grupo verde claro é composto do Oficial Investigador de Polícia, Agente de Polícia Judiciária e Agente de Perícia Criminal. Claramente, houve confusão na medição numérica destes cargos.
4. O quarto grupo de cor azul é composto pelo Agente de Perícia Médico Legal e o Papiloscopista Policial, de apoio à perícia e papiloscopia.
5. Por fim, o grupo dos Peritos Criminais explícitos em roxo, com o Médico Legista e Perito Criminal.

Apesar de boa distribuição numérica, o algoritmo teve dificuldade em colocar os cargos centrais conforme delineados pela proposta de reestruturação. O Papiloscopista Papiloscopista ficou fora do grupo do Oficial Investigador de Polícia e Investigação, ficando pelo menos no apoio a perícia.

####3.5.2 Condensada

Início com a régua de Gower.
"""

def regua_gower(df):
  quant_carreiras = len(df)

  #Função que explora os cargos com mais similaridades (menores valores) criando uma régua de similaridade
  #O cargo de Delegado de Polícia é o início da régua com valor zero
  global regua_gower
  regua_gower = gower.gower_topn(df.iloc[:,:], df, n = quant_carreiras)

  return regua_gower

regua_gower(cargos_atrib_restr_condensed)

"""Gerando a tabela para melhor visualizar."""

tabela_gower(cargos_atrib_restr_condensed)

"""Observando a tabela gerada da reestruturação condensada:
1. Delegado está no começo da lista com zero (Delegados).
2. O Escrivão de Polícia, Oficial de Polícia Judiciária e o Agente de Polícia Judiciária ocupam a mesma posição, criando um grupo de Investigação e Apoio à Investigação.
3. O Papiloscopista Policial vem em seguida, no centro da régua.
4. O Agente de Perícia Criminalística e o Perito Criminal seguem, em um grupo de Perícia e Apoio à Perícia Criminalística.
5. Por último, segue o Agente de Perícia Médico Legal (com mesma posição do Perito Criminal) e o Médico Legista, em um grupo de Perícia e apoio à perícia Medicina Legal.

Vendo a Tabela de Gower Condensada, levando em consideração as distâncias relativas calculadas com a métrica de Jaccard, pode-se observar os valores de distância entre os cargos em pauta. Deve-se atentar que os valores estão em relação ao ponto zero (Delegado de Polícia).

Oficial Investigador de Polícia : 0.210526.

Perito Papiloscopista: 0.315789.

Perito Criminal: 0.473684.


A régua organiza as diferentes áreas periciais e até de investigação, reduzindo as distâcias entre Papiloscopistas Policiais e Oficiais Investigadores Policiais, e aumentando entre Papiloscopista Policial e Perito Criminal. Necessário verificar na Representação Linear como é feita a distribuição.
"""

n_grupos = 5 #Delegados, investigação, apoio à investigação, perícia e apoio a perícia.

titulo = 'Distância Relativa - Restruturação PCSP 2024 Condensada'

repr_linear, dist_linear = representacao_linear(titulo)

"""Observando a representação linear proposta:
1. Delegado de Polícia está na base separado, em laranja.
2. O segundo grupo contemplar a investigação em azul, com o Escrivão de Polícia, Oficial Investigador de Polícia e Agente de Polícia Judiciária.
3. O Papiloscopista fica sozinha em verde, num grupo relativo a papiloscopia.
4. Um quarto grupo em roxo comtempla o Agente de Perícia Criminalística, o Perito Criminal e o Agente de Medicina Legal, colocando apoio a perícia com a Perícia Criminalística em um mesmo grupo.
5. Por último, em vermelho, está o Médico Legista, com a Perícia Médico legal.

Apesar de certa lógica, houve confusão nas perícias e apoios à perícia. Curiosamente, o Papiloscopista Policial continuou fora do grupo de Oficial Investigador de Polícia e Investigação.

##3.6 - Comentários Gerais
A situação atual sem correções já aponta proximidade entre o Perito Criminal com o Papiloscopista, principalmente quando a quantidade de atribuições não é reduzida. Tal fato é reduzido com a aglutinação de atribuições, mas ainda assim estão em grupos de perícia e apoio a essa.

As correções propostas sempre levam Peritos Criminais e Papiloscopista Policiais a ficarem próximos, algumas vezes em mesma posição, distanciando do Investigador de Polícia.

Ao tentar adequar a LONPC, a mera transposição da situação dos editais leva o Investigador a ficar entre as perícias quando a tabela original não reduzida é utilizada. Ao condensar, o Papiloscopista Policial fica mais próximo do Investigador de Polícia, distantes dos outros peritos. Isso sugere que a adequação a LONPC deve vir acompanhada de correções para que todas as atribuições sejam levadas em conta, e uma má restruturação poderia deixar Papiloscopista em situação díspar dos outros peritos.

Quando levadas a LONPC com correções, a situação fica mais estável, com pouco se divergindo, atingindo a melhor representação na condensada, onde os grupos gerados coadunaram com a proposta da LONPC e seguem a lógica de Delegados de Polícia, Investigação, Apoio à Perícia e Peritos.

Ao atentar-se a reestruturação proposta, ainda houve separação do Oficial Investigador de Polícia com o Papiloscopista Policial. Contudo, este se afastou do Perito Criminal, sendo um perícia menor (Papiloscopia apenas) ou pelo menos um apoio à perícia.

#4 - Dendogramas e Índice Cofenético
Com os dados das tabelas de distâncias feitas no item 2, é possível gerar dendogramas similares a árvores taxônomicas para efeito comparativa.
Após a criação, pode-se calcular o índice cofenético para verificar a correlação entre a tabela de distância e o dendograma. É utilizado a mesma lógica do coeficiente de Pearson. Valores próximos a 1 indicam correlação positiva forte, próximos a -1, correlação negativa forte, próximos a 0, não há correlação.

##4.1 Atual sem correção

####4.1.1 Original

Inicialmente, criar o organizador segundo a tabela de distâncias geradas no item 2.
"""

def gerando_dict_pdict(df_dist):
  global dict_pdict
  dict_pdict = {}
  global distance_matrix
  distance_matrix = np.concatenate(list(df_dist.values()))

  dict_pdict = linkage(
        y = distance_matrix,
        method = 'single',
        metric = 'jaccard',
        optimal_ordering = True
  )
  return dict_pdict

"""Calculando dict_pdist novamente."""

processamento_dados(cargos_atrib_atual_nocor)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_nocor)

"""Verificando o dict_pdist."""

dict_pdist

"""Gerando o dict_pdict para gerar o dendograma."""

gerando_dict_pdict(dict_pdist)

"""Confirmando a geração do dict_pdict."""

dict_pdict

"""Verificando a matrix de distância gerada."""

distance_matrix

"""Gerando o dendograma."""

def dendograma(dict_pdict, df, titulo):
  fig = plt.figure(figsize=(6,6))

  dendrogram(
      Z = dict_pdict,
      labels = df["Carreira"].tolist(),
      count_sort = True,
      orientation = 'right',
      leaf_font_size = 10
  )

  plt.title(titulo)
  plt.xticks(rotation=90)
  plt.show()

"""O dendograma permite verificar quais são mais derivados / especializados (aqueles com alturas mais baixas) ou basais / generalistas (aqueles com alturas mais altas) e também a proximidade de cada cargo (proximidade horizontal)."""

titulo = 'Dendograma - Cargos Atuais Original Sem correções'

dendograma(dict_pdict,cargos_atrib_atual_nocor, titulo)

"""Após gerar o dendograma, é possível verificar os seguintes resultados:
1. Há um clado mais basal, formado pelo Atendente de Necrotério Policial, um subgrupo de apoio à investigação (Carcereiro Policial, Agente de Telecomunicações Policial e Agente Policial), Escrivão de Polícia e Delegado de Polícia.
2. O mais próximo desses basais é o Investigador de Polícia, já derivando em um próximo clado.
3. A próxima derivação vem com o Auxiliar de Necrópsia Policial.
4. Segue-se a derivação do Fotógrafo Técnico Pericial e do Desenhista Técnico Pericial, no grupo de apoio a perícia criminalística.
5. Continuando, gerando no penúltimo clado, temos o grupo das Perícias SPTC, com o Médico Legista e o Perito Criminal.
6. O último clado demonstra o Auxiliar de Papiloscopista Policial e Papiloscopista Policial, com apoio e perícia papiloscópica.

No geral, as posições estão consistentes, com exceção do Atendente de Necrotério, que deveria estar mais derivado em relação ao Investigador de Polícia.

Calculando o índice cofenético.
"""

def cofenetico(dict_pdict, dict_pdist, titulo):
  global cophenetic_table, cophenetic_index
  cophenetic_table = cophenet(
    Z = dict_pdict,
    Y = distance_matrix)

  cophenetic_index = cophenetic_table[0]

  print(titulo)
  print(f"Valor:", cophenetic_index)
  if (cophenetic_index < -0.9):
    print("Correlação negativa forte")
  elif (cophenetic_index < -0.5):
    print("Correlação negativa fraca")
  elif (cophenetic_index < 0.5):
    print("Sem correlação aparente")
  elif (cophenetic_index < 0.75):
    print("Correlação positiva moderada")
  else:
    print("Forte correlação positiva")

titulo = "Índice Cofenético - Atual Original sem correção"

cofenetico(dict_pdict, dict_pdist, titulo)

"""Forte correlação entre os dados gerados na tabela de distância e na tabela de para o dendograma, ainda que desorganizada e sem correções.

####4.1.2 Condensada

Início calculando as tabelas de distanciamente e dicionário para os dendogramas.
"""

processamento_dados(cargos_atrib_atual_nocor_condensed)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_nocor_condensed)

"""Gerando pdict."""

gerando_dict_pdict(dict_pdist)

"""Gerando novo dendograma."""

titulo = 'Dendograma - Cargos Atuais Condensado Sem correções'

dendograma(dict_pdict,cargos_atrib_atual_nocor_condensed, titulo)

"""Após gerar o dendograma dos atributos condensados, é possível verificar os seguintes resultados:
1. O clado mais basal, de cor azul, é formado pelo Atendente de Necrotério Policial, um subgrupo de apoio à investigação (Carcereiro Policial, Agente de Telecomunicações Policial e Agente Policial), Escrivão de Polícia e Delegado de Polícia continua existindo.
2. O mais próximo desses basais é o Investigador de Polícia, já derivando em um próximo clado, como observado.
3. A próxima derivação vem com o Auxiliar de Necrópsia Policial, como observado.
4. A partir deste ponto há distinções em valores, criando clados em outras cores. Contudo, a disposição dos cargos permenece a mesma. Um primeiro subgrupo em ver é do Desenhista Técnico Pericial e do Fotógrafo Técnico Pericial, ambos do apoio da perícia criminalística.
5. Segue-se um subgrupo no último clado de peritos SPTC, com o Médico Legista e Perito Criminal.
6. No último subgrupo estão Auxiliar de Papiloscopia Policial e Papiloscopista Policial, num grupo de Papiloscopia.

No geral, as posições estão consistentes, com exceção do Atendente de Necrotério, que deveria estar mais derivado em relação ao Investigador de Polícia. Os valores são mais expressivos, criando os subgrupos coloridos no dendograma.

Com isso, pode-se calcular o índice cofenético.
"""

titulo = "Índice Cofenético - Atual Condensado sem correção"

cofenetico(dict_pdict, dict_pdist, titulo)

"""Forte correlação entre os dados gerados na tabela de distância e na tabela de para o dendograma, apesar de cair um pouco o valor em relação a original.

##4.2 Atual com correção

####4.2.1 Original

Início calculando as tabelas de distanciamente e dicionário para os dendogramas.
"""

processamento_dados(cargos_atrib_atual_withcor)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_withcor)

"""Gerando pdict."""

gerando_dict_pdict(dict_pdist)

"""Gerando novo dendograma."""

titulo = 'Dendograma - Cargos Atuais Original Com correções'

dendograma(dict_pdict,cargos_atrib_atual_withcor, titulo)

"""Observando o dendograma gerado, pode-se inderir que:
1. O Delegado de Polícia segue na base.
2. O primeiro subgrupo derivado é o de investigação, com o Escrivão de Polícia e o Investigador (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial).
3. Segue-se um subgrupo derivado de apoio a perícia criminalística, com Desenhista Técnico Pericial e Fotógrafo Técnico Pericial.
4. Segue depois o Perito Criminal.
5. Neste clado do Perito Criminal, há um segundo clado em laranja, o mais especializado de todos, de papiloscopia, com o Auxiliar de Papiloscopista Policial e o Papiloscopista Policial.
6. O último grande clado representa os cargos de medicina legal, com o Atendente de Necrotério Policial, Auxiliar de Necrópsia Policial e por último o Médico Legista.

A organização demonstrou que o delegado e os cargos de investigação são mais basais, seguidos dos cargos intercalados sempre entre apoio as perícias e seus respectivos perito, na ordem de Criminalística, Papiloscopia e Medicina Legal. Aparentemente, uma boa organização, ainda que não tenha feito o apoio a perícia em um subgrupo e as perícias em si em outro. Deve-se verificar o índice cofenético.
"""

titulo = "Índice Cofenético - Atual Original com correção"

cofenetico(dict_pdict, dict_pdist, titulo)

"""Apesar de diminuir um pouco, ainda apresenta uma sólida correlação dos dados.

####4.2.2 Condensada

Início com os calculos das distâncias e dicionários.
"""

processamento_dados(cargos_atrib_atual_withcor_condensed)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_atual_withcor_condensed)

"""Gerando o pdict."""

gerando_dict_pdict(dict_pdist)

"""Dendograma da tabela original com correções."""

titulo = 'Dendograma - Original Condensada Com correções'

dendograma(dict_pdict,cargos_atrib_atual_withcor_condensed, titulo)

"""Após gerar o dendograma dos atributos condensados, é possível verificar os seguintes resultados:
1. Inicia-se o dendogramca com o Delegado de Polícia sendo o mais basal dos cargos, em azul.
2. O primeiro subgrupo formado é o de investigação, com o Investigador de Polícia (+ Agente de Telecomunicações + Agente Policial + Carcereiro Policial) e Escrivão de Polícia.
3. A próxima derivação é do Atendente de Necrotério Policial.
4. Mais uma derivação com um subgrupo do Fotógrafo Técnico Policial e Desenhista Técnico Pericial, apoio a perícia criminalística.
5. Os próximos subgrupos são derivados suficientes para assumirem a cor laranja. Inicia-se bem especializado o Médico Legista e o Auxiliar de Necrópsia Policial.
6. A próxima derivação é do Perito Criminal.
7. Por fim, mais derivado, fica o Auxiliar de Papiloscopista Policial e o Papiloscopista Polical, num grupo de papiloscopia.

No geral, as posições estão consistentes, com com alguma confusão nos cargos e apoio à perícia e perícia em si. Os valores são mais expressivos, criando os subgrupos coloridos no dendograma.

Com isso, pode-se calcular o índice cofenético.
"""

titulo = "Índice Cofenético - Atual Condensado com correção"

cofenetico(dict_pdict, dict_pdist, titulo)

"""O valor ficou próximo do calculado sem redução, mas continua forte.

##4.3 LONPC sem correção

####4.3.1 Original

Início com os calculos das distâncias e dicionários.
"""

processamento_dados(cargos_atrib_LONPC_nocor)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_nocor)

"""Gerando o pdict."""

gerando_dict_pdict(dict_pdist)

"""Dendograma da LONPC sem correções."""

titulo = 'Dendograma - LONPC, Original Sem correções'

dendograma(dict_pdict,cargos_atrib_LONPC_nocor, titulo)

"""Observando o dendograma gerado, pode-se suscitar:
1. O Oficial Investigador de Polícia se tornou o mais basal dos cargos, em um mesmo npivel que o Delegado de Polícia.
2. O terceiro cargo mais derivado ficou com o Agente de Perícia Médico Legal.
3. Segue-se o Agente de Perícia Criminalística.
4. O penúltimo clado fica com o Perito Papiloscopista e o Agente de Perícia Papiloscópica.
5. Por fim, o Perito Criminal e o Médico Legista ocupam o último clado.

Claramente houve desorganização nos cargos, deslocando os cargos de delegado, investigação, apoio a perícia e perícia. A mera adequação dos cargos sem correções enseja nesses erros. Necessário verificar o índice cofenético.
"""

titulo = "Índice Cofenético - LONPC Original sem correção"

cofenetico(dict_pdict, dict_pdist, titulo)

"""Apesar de ser um bom índice, 0,75 é um número baixo em relação aos 0,9 dos outros dois, indicando pobreza na organização dos dados.

####4.3.2 Condensada

Início com os calculos das distâncias e dicionários.
"""

processamento_dados(cargos_atrib_LONPC_nocor_condensed)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_nocor_condensed)

"""Gerando o pdict."""

gerando_dict_pdict(dict_pdist)

"""Dendograma da LONPC condensada sem correções."""

titulo = 'Dendograma - LONPC Condensada Sem correções'

dendograma(dict_pdict,cargos_atrib_LONPC_nocor_condensed, titulo)

"""Observando o dendograma gerado das atribuições condensadas, pode-se suscitar:
1. O Oficial Investigador de Polícia se tornou o mais basal dos cargos, em um mesmo npivel que o Delegado de Polícia, como observado.
2. Há um subgrupo em laranja de papiloscopia, com o Perito Papiloscopista e o Agente de Perícia Papiloscópia.
3. Segue derivado em memso nível o Agente de Perícia Médico Legal e o Agwente de Perícia Criminalística.
4.Por fim, em verde, grupo com as perícias SPTC, com o Médico Legista e o Perito Criminal.

A posição do Perito Papiloscopista aparentemente está fora do lugar, mais basal ao invés do mais derivada com os peritos da SPTC. Necessário verificar o índice cofenético.
"""

titulo = "Índice Cofenético - LONPC Condensado sem correção"

cofenetico(dict_pdict, dict_pdist, titulo)

"""Índice melhorou um pouco em relação ao original não condensado, e é um valor relativamente forte.

##4.4 LONPC com correção

####4.4.1 Original

Primeiro, distâncias e dicionários.
"""

processamento_dados(cargos_atrib_LONPC_withcor)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_withcor)

"""Gerando o pdict."""

gerando_dict_pdict(dict_pdist)

"""Gerando o Dendograma."""

titulo = 'Dendograma - LONPC Original Com correções'

dendograma(dict_pdict,cargos_atrib_LONPC_withcor, titulo)

"""Ao observar o dendograma gerado, observa-se:
1. O Oficial Investigador de Polícia é o cargo mais basal.
2. Segue-se o Delegado de Polícia.
3. Há grande variação de altura, com um primeiro clado especialista em laranja, com o Médico Legal e o Agente de Perícia Médico Legal, o clado da Medicina Legal.
4. O Agente de Perícia Criminalística segue mais derivado, seguido do Perito Criminal, o que indica um pseudoclado de Perícia Criminalística.
5. Por fim, o clado mais especializado em verde é o de Papiloscopia, com o Perito Papiloscopista e o Agente de Perícia Papiloscópica.

Aparentemente, excetuando a posição entre o Delegado de Polícia e do Oficial Investigador, há boa ordenação nos cargos, o que deve se refletir no índice cofenético.
"""

titulo = "Índice Cofenético - LONPC Original com correção"

cofenetico(dict_pdict, dict_pdist, titulo)

"""Forte correlação, acima de 0,91, indicando boa adequação dos dados.

####4.4.2 Condensada

Início com os calculos das distâncias e dicionários.
"""

processamento_dados(cargos_atrib_LONPC_withcor_condensed)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_LONPC_withcor_condensed)

"""Gerando o pdict."""

gerando_dict_pdict(dict_pdist)

"""Dendograma da LONPC condensada com correções."""

titulo = 'Dendograma - LONPC Condensada Com correções'

dendograma(dict_pdict,cargos_atrib_LONPC_withcor_condensed, titulo)

"""Ao observar o dendograma gerado pelas atribuições condensadas, observa-se:
1. O Oficial Investigador de Polícia é o cargo mais basal, conjuntamento com o Delegado de Polícia, nos clado em azul.
2. O Agente de Perícia Crimin é o primeiro a derivar.
3. Os próximos subgrupos assume valores mais expressivos, adotando a cor laranja para diferenciação. O Agente de Perícia Papiloscópica e o Perito Papiloscopista estão no próximo, com papiloscopia.
4. Há uma derivação com o Agente de Perícia Técnico Pericial.
5. O último grupo é das perícias SPTC, com o Perito Criminal e o Médico Legista.

As reduções melhoraram de alguma força dos cargos, mas ainda apresenta deorganizações. Deve-se calcular o índice cofenético para verificar se os dados coadunam.
"""

titulo = "Índice Cofenético - LONPC Condensada com correção "

cofenetico(dict_pdict, dict_pdist, titulo)

"""Melhorou um pouco em relação a não condensada, mas com valor ainda forte.

##4.5 Reestruturação proposta pela PCSP 2024

####4.5.1 Original

Primeiro, distâncias e dicionários.
"""

processamento_dados(cargos_atrib_restr)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_restr)

"""Gerando o pdict."""

gerando_dict_pdict(dict_pdist)

"""Gerando o Dendograma."""

titulo = 'Dendograma - Reestruturação PCSP 2024 Original'

dendograma(dict_pdict,cargos_atrib_restr, titulo)

"""Ao observar o dendograma gerado, observa-se:
1. O Delegado de Polícia ocupa a posição mais basal do dendograma.
2. Há um segundo clado bem basal afeito a Investigação, com o Escrivão de Polícia (cartório) em um braço mais próximo de Delegado e o Agente de Polícia Judiciária com o Oficial Investigador de Polícia (investigação e apoio à investigação).
3. O Papiloscopista Policial vem basal com a Investigação, todos os listado em azul, mantendo-o em distância da perícia e do apoio à perícia, mas mais próximo em distância com essas em relação aos outros cargos listados.
4. O clado mais derivado em verde é o de Medicina Legal e apoio à Medicina Legal, com o Agente de Perícia Médico Legal e o Médico Legista.
5. Por último, também derivado, mas não tanto quanto o de Medicina Legal, está o clado vermelho de Perícia Criminalística com o Perito Criminal e o Agente de Perícia Criminal.

Claramente, a manutanção das diferenças entre Papiloscopista Policial e os peritos explícitos além da criação de institutos não periciais colocou o Papiloscopista em grupo mais basal, mais relativo a Investigação, mas ainda respeitando uma pequena proximidade com as Perícias e seus apoios.

Deve-se ver qual a força do índice cofenético para essa situação.
"""

titulo = "Índice Cofenético - Restruturação Original"

cofenetico(dict_pdict, dict_pdist, titulo)

"""O Índice apontou forte correlação, o que indica que a deliniação dessas propostas faria sentido somente a luz das adaptações.

####4.5.2 Condensada

Primeiro, distâncias e dicionários.
"""

processamento_dados(cargos_atrib_restr_condensed)

#Chamando as funções para definir as variáveis
dict_pdist, dict_pdist_squared, tabelaDistCargos, tabelaCorrelation = tabelas_distancia(cargos_atrib_restr_condensed)

"""Gerando o pdict."""

gerando_dict_pdict(dict_pdist)

"""Gerando o Dendograma."""

titulo = 'Dendograma - Restruturação Condensada'

dendograma(dict_pdict,cargos_atrib_restr_condensed, titulo)

"""Ao observar o dendograma gerado pelas atribuições condensadas, observa-se:
1. O Delgado é o grupo mais basal, em azul.
2. Um clado de Investigação e apoio à investigação surge em laranja, agora derivado em comparação ao não condensado.
3. Um grande grupo em verde mais derivado surge, com a Papiloscopia, Apoio à Perícia e Perícias. O Papiloscopista ainda fica mais próximo à Investigação. O Agente de Perícia Criminalística segue na derivação,  com os três cargos mais derivados em memso nível o Agente de Perícia Medicina Legal (mais próximo do Agente de Perícia Criminalística), Médico legista e Perito Criminal.

Ao se reduzir a magnitude das atribuições, é possível ver que o Papiloscopia ainda fica afeito as Perícias, mas mais basal em relação a outros apresentados. Isso indica que a redução de atribuições periciais e a criação de atribuições díspares afasta o Papiloscopista das suas reais atribuições.

Abaixo o índice cofenético.
"""

titulo = "Índice Cofenético - Restruturação Condensada"

cofenetico(dict_pdict, dict_pdist, titulo)

"""A correlação também segue forte, ainda que tenha caído, apresentando a mesma situação da não condensada para a Reestruturação.

##4.6 - Comentários Gerais
Nas árvores hierárquicas, também chamadas de dendogramas, a situação atual, com e sem correções, aponta o Papiloscopista e Perito Criminais mais derivados, especializados e próximos, ao passo que o Investigador de Polícia está mais basal, próximos a cargos do cartório e apoio à investigação. Ao aglutinar atribuições, essa tendência aumenta.

Quando as árvores da LONPC sem correções são geradas, a original sem aglutinações de atribuições, as árvores com Papiloscopista e Peritos Criminais estão próximos devido o peso da quantidade de atribuições. Ao condensar atribuições, Papiloscopista Policias ainda continuam derivados, nas perícias, mas um pouco menos próximos, com uma leve diminuição da sua derivação, o que indicaria que um adequação simplista das atribuições sem correções poderia suscitar uma proximidade com o cargo de investigação.

Ao adequar a LONPC com correções, o Papiloscopista Policial está no grupo mais derivado com o Perito Criminal. Ao condensar as atribuições, o grupo pericial ainda se mantem coeso, indicando que correções ao adequar a LONPC são necessárias.

Com a restruturação, claramente o Papiloscopista passa a integrar o grupo de investigação, indicando que a aglutinação com o Auxiliar de Papiloscopista e a criação de institutos alheios a perícia, sem a devida correção, joga o Papiloscopista a grupos mesmo afeitos a sua origem. Ao reduzir a magnitude das atribuições essa tendência diminuí, com o Papiloscopista pelo menos se mantendo no grupo de Perícias e apoio à Perícia.

#5 - Diagrama de Grafos
Uma outra opção de visualização dos cargos seria através do Diagrama de Grafos. Este tipo de visualização permite ver a conexão entre carreiras e sua disposição, de forma a ver suas relações de forma espacial e força o tamanho de arestas.

##5.1 Atual sem correção
Primeiro, deve-se construir a matrix de adjacência. Caso haja conexão entre os cargos, o valor na linha x coluna recebe 1. Caso contrário, fica 0. A força dessa conexão é o número de atribuições compartilhadas.
Abaixo a construção da Matrix de Adjacência e dos Vetores de Arestas com pesos. A matrix condensada não pode ser utilizada nessa análise, somente a expandida original.
"""

#Função dos vetores da Matrix de Adjacência

def matrix_adjacencia(df, titulo):
  #Criando a Arestas do Diagrama de Grafos
  df_copia = df

  #Retirando cargos comuns a todos do DF.
  cols_all_ones = df_copia.loc[:, (df_copia == 1).all()].columns.tolist()
  df_copia = df_copia.drop(cols_all_ones, axis=1)

  #Criação da Matrix com todos os valores 0
  global matrix_adj
  matrix_adj = np.zeros((len(df_copia), len(df_copia)))
  #vetor com as arestas e pesos
  global arestas
  arestas = []

  #Iterando de forma progressiva todos os cargos
  for i in range(0, len(df_copia)):
    j = i + 1
    for j in range(j, len(df_copia)):
      vetor_carreira = []
      shared_cols = 0
      peso_atrib = 0
      numeric_df = df_copia.apply(pd.to_numeric, errors='coerce')
      shared_cols =df_copia.columns[(df_copia.iloc[i] == 1) & (df_copia.iloc[j] == 1)]
      peso_atrib = len(shared_cols)
      if peso_atrib > 0: #Caso compartilhem atribuições
        #Cargo 1 aponta para cargos 2 e tem como peso a quantidade de atribuições compartilhadas
        #Não representadas não possuem compartilhamento
        matrix_adj[i][j] = 1 #aresta
        matrix_adj[j][i] = 1 #reciproco
        vetor_carreira = [i, j, peso_atrib]
        arestas.append(vetor_carreira)

  print('Matrix de Adjacência / Vetores de Arestas e Pesos')
  print(titulo)
  print("Cargo 1 - Cargo 2 - Peso (as direções são recíprocas)")
  return matrix_adj, arestas

titulo = 'Cargos Atuais sem correções'

matrix_adjacencia(cargos_atrib_atual_nocor, titulo)

"""Matrix de adjacência colorida com pesos."""

def heatmap_tabela_adj(df, tabelaAdj, arestas, titulo, color_map):
  matrix_adj_com_pesos = tabelaAdj
  vmax = 0
  for aresta in arestas:
    matrix_adj_com_pesos[aresta[0], aresta[1]] = aresta[2]
    matrix_adj_com_pesos[aresta[1], aresta[0]] = aresta[2]
    max_atual = aresta[2]
    if max_atual > vmax:
      vmax = max_atual
  matrix_adj_com_pesos = np.array(matrix_adj_com_pesos)
  for i in range(len(matrix_adj_com_pesos)):
    matrix_adj_com_pesos[i,i] = "NaN"

  tabelaAdj = pd.DataFrame(matrix_adj_com_pesos, columns=df['Carreira'], index=df['Carreira'])

  fig, ax = plt.subplots(figsize=(18, 12))

  heatmap = sns.heatmap(tabelaAdj, annot=True, cbar=False)
  sns.heatmap(tabelaAdj, cmap=color_map, vmin=0, vmax=vmax,
              center=0, linewidths=1, annot=True, square=True,
              linecolor='black', cbar=True)

  plt.title(titulo, fontsize=20)
  plt.show()

titulo = "Tabela Adjacência com pesos - Atual Sem Correção"
color_map = "BrBG"

heatmap_tabela_adj(atrib_gerais_no_cor, matrix_adj, arestas, titulo, color_map)

"""Plotando o Diagrama de Grafos. As cores foram setadas em azul claro para grupos dos Delegados, vermelho para Investigação, violeta para Perícia, verde claro para apoio à perícia e laranja para apoio à Investigação (quando disponível). Essas cores não afetam os cálculos, somente a estética do diagrama."""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo,
                   tamanho_fonte):
  fig = plt.figure(figsize=(12,12))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)
  legenda_inicial = mpatches.Patch(color='white', label='LEGENDA:')
  handles = [legenda_inicial]

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    descricao_legenda = str(i)+": "+cargo
    if (cargo in cor_cargos_delegado):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"azul"
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"vermelho"
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"roxo"
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"cinza"
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"laranja"
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"verde"
      cor = "lightgreen"
    else:
      nome_variavel_legenda = "erro_legenda"
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    patch = mpatches.Patch(color=cor, label=descricao_legenda)
    handles.append(patch)
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
    #legendas das arestas
    nome_variavel_legenda = "aresta_"+str(arestas[i][0])+"_"+str(arestas[i][1])
    descricao_legenda = str(arestas[i][0])+" "+df["Carreira"].iloc[arestas[i][0]]+' <-> '+str(arestas[i][1])+" "+df["Carreira"].iloc[arestas[i][1]]+' - Peso: ' + str(peso)
    patch = mpatches.Patch(color='black', label=descricao_legenda)
    handles.append(patch)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  aresta_outro = mpatches.Patch(color='white', label='outros cargos: Peso 0 <-> Sem conexão')
  handles.append(aresta_outro)

  font_prop = fm.FontProperties(size=tamanho_fonte) # Use fm instead of plt.font_manager

  plt.legend(handles=handles, bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0., prop=font_prop)

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Escrivão de Polícia", "Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Papiloscopista Policial"]
cargos_papiloscopia = []
cargos_apoio_investigacao = ["Carcereiro Policial", "Agente de Telecomunicações Policial", "Agente Policial"]
cargos_apoio_pericia = ["Auxiliar de Papiloscopista Policial", "Fotógrafo Técnico Pericial",
            "Desenhista Técnico Pericial", "Auxiliar de Necrópsia Policial", "Atendente de Necrotério Policial"]

tamanho_fonte = 14

titulo = 'Diagrama de Grafos - Cargos Atuais, Sem Correções'

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_atual_nocor, titulo,
               tamanho_fonte)

atrib_comp_cargos(atrib_gerais_no_cor)

"""Observando o Diagrama, percebe-se que (a lista de atribuições compartilhadas está acima para conferência):

1. Delegado de Polícia (0) não possuí atribuições compartilhadas.

2. Escrivão de Polícia (1) não possuí atribuições compartilhadas.

3. O Investigador de Polícia (2) e o Desenhista Técnico Pericial (11) só possuem 1 atributo compartilhado.

4. O Perito Criminal (3) possuí atribuições compartilhadas com todos os cargos pericias e três de apoio à perícia, entre eles:

  4.1 - Médico Legista (4) - 3 atribuições.

  4.2 - Papiloscopista Policial (5) - 2 atribuições.

  4.3 - Auxiliar de Papiloscopista Policial (6) - 2 atribuições.

  4.4 - Fotógrado Técnico Pericial (10) - 1 atribuição.

  4.5 - Desenhista Técnico Pericial (11) - 2 atribuições.

  4.6 - Auxiliar de Necrópsia Policial (12) - 1 atribuição.

5. O Médico Legista (4) possuí atribuições com Perito Criminal (3 - já listadas) e três dos cargos de apoio à perícia, entre eles:

  5.1 - Fotógrado Técnico Pericial (10) - 1 atribuição.

  5.2 - Desenhista Técnico Pericial (11) - 1 atribuição.

  5.3 - Auxiliar de Necrópsia Policial (12) - 1 atribuição.

6. O Papiloscopista Policial (5) possuí atribuições com o Perito Criminal (3 - já listado)  e dois dos cargos de apoio à perícia:

  6.1 - Auxiliar de Papiloscopista Policial (6) - 2 atribuições.

  6.2 - Desenhista Técnico Pericial (11) - 1 atribuição.

7. O Auxiliar de Papiloscopista Policial (6) possuí atribuições com Perito Criminal (3), Papiloscopista Policial (5), ambos já listados, e Desenhista Técnico Pericial (11), este último com 1 atribuição.

8. Todos os cargos de apoio à investigação, Agente de Telecomunicações Policial (7), Agente Policial (8) e Carcereiro Policial (9), não possuem atribuições entre eles ou com qualquer outro cargo.

9. O Fotógrafo Técnico Pericial (10) possuí atribuições com dois do cargos periciais (Perito Criminal (3) e Médico Legista (4)), ambos já listados.

10. O Desenhista Técnico Pericial (11) possuí atribuições com o Investigador de Polícia (2), todos os cargos periciais (Perito Criminal (3), Médico Legista (4) e Papiloscopista (5)), e dois dos cargos de apoio à perícia (Auxiliar de Papiloscopista Poplicial (6) e Fotógrafo Técnico Pericial (10)), todos anteriormente listados.

11. O Auxiliar de Necrópsia Policial (12) possuí atribuições com dois dos cargos periciais (Perito Criminal (3) e Médico Legista (4)), ambos já listados anteriormente.

12. O Atendente de Necrotério Policial (13) não possuí atribuições compartilhadas.

No geral, o Delegado de Polícia não se conecta com nenhum cargo. Não há conexão intra e inter cargos de investigação e apoio à investigação. Há uma conexão de Investigador de Polícia com Desenhista Técnico Pericial, o qual aparenta ser espúria. Cargos periciais e de apoio à perícia apresenta maiores conexões entre si tanto em arestas como em atribuições.

Para facilitar a manipulação de imagens, foi criado o diagrama de grafos sem a legenda.
"""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo):
  fig = plt.figure(figsize=(8,8))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    if (cargo in cor_cargos_delegado):
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      cor = "lightgreen"
    else:
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos Sem Legenda
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Escrivão de Polícia", "Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Papiloscopista Policial"]
cargos_papiloscopia = []
cargos_apoio_investigacao = ["Carcereiro Policial", "Agente de Telecomunicações Policial", "Agente Policial"]
cargos_apoio_pericia = ["Auxiliar de Papiloscopista Policial", "Fotógrafo Técnico Pericial",
            "Desenhista Técnico Pericial", "Auxiliar de Necrópsia Policial", "Atendente de Necrotério Policial"]

titulo = 'Diagrama de Grafos - Cargos Atuais, Sem Correções'

diagrama_grafo_clean(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_atual_nocor, titulo)

"""##5.2 Atual com correção
Inicialmente, contruir a matriz de adjacência e as arestas.
"""

titulo = 'Cargos Atuais com correções'

matrix_adjacencia(cargos_atrib_atual_withcor, titulo)

"""Matrix de adjacência colorida com pesos."""

titulo = "Tabela Adjacência com pesos- Atual Com Correção"
color_map = "PiYG"

heatmap_tabela_adj(atrib_gerais_with_cor, matrix_adj, arestas, titulo, color_map)

"""Plotando Diagrama de Grafos."""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo,
                   tamanho_fonte):
  fig = plt.figure(figsize=(12,12))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)
  legenda_inicial = mpatches.Patch(color='white', label='LEGENDA:')
  handles = [legenda_inicial]

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    descricao_legenda = str(i)+": "+cargo
    if (cargo in cor_cargos_delegado):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"azul"
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"vermelho"
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"roxo"
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"cinza"
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"laranja"
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"verde"
      cor = "lightgreen"
    else:
      nome_variavel_legenda = "erro_legenda"
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    patch = mpatches.Patch(color=cor, label=descricao_legenda)
    handles.append(patch)
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
    #legendas das arestas
    nome_variavel_legenda = "aresta_"+str(arestas[i][0])+"_"+str(arestas[i][1])
    descricao_legenda = str(arestas[i][0])+" "+df["Carreira"].iloc[arestas[i][0]]+' <-> '+str(arestas[i][1])+" "+df["Carreira"].iloc[arestas[i][1]]+' - Peso: ' + str(peso)
    patch = mpatches.Patch(color='black', label=descricao_legenda)
    handles.append(patch)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  aresta_outro = mpatches.Patch(color='white', label='outros cargos: Peso 0 <-> Sem conexão')
  handles.append(aresta_outro)

  font_prop = fm.FontProperties(size=tamanho_fonte) # Use fm instead of plt.font_manager

  plt.legend(handles=handles, bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0., prop=font_prop)

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Escrivão de Polícia", "Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial)"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Papiloscopista Policial"]
cargos_papiloscopia = []
cargos_apoio_investigacao = []
cargos_apoio_pericia = ["Auxiliar de Papiloscopista Policial", "Fotógrafo Técnico Pericial",
            "Desenhista Técnico Pericial", "Auxiliar de Necrópsia Policial", "Atendente de Necrotério Policial"]
titulo = 'Diagrama de Grafos - Cargos Atuais, Com Correções'

tamanho_fonte = 8.5

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_atual_withcor,
               titulo, tamanho_fonte)

atrib_comp_cargos(cargos_atrib_atual_withcor)

"""Observando o Diagrama, percebe-se que (a lista de atribuições compartilhadas está acima para conferência):

1. Delegado de Polícia (0) não possuí atribuições compartilhadas.

2. Escrivão de Polícia (1) e Investigador de Polícia (2) só possuem 1 atributo compartilhado.

3. O Investigador de Polícia (+ Agente de Telecomunicações Policiais + Agente Policial + Carcereiro (2) possuí atribuições compartilhadas com o Escrivão de Polícia (1 - já listado anteriormente) e o Desenhista Técnico Pericial (8), com 1 atributo compartilhado.

4. O Perito Criminal (3) possuí atribuições compartilhadas com todos os cargos pericias e todos de apoio à perícia, entre eles:

  4.1 - Médico Legista (4) - 8 atribuições.

  4.2 - Papiloscopista Policial (5) - 10 atribuições.

  4.3 - Auxiliar de Papiloscopista Policial (6) - 6 atribuições.

  4.4 - Fotógrado Técnico Pericial (7) - 5 atribuições.

  4.5 - Desenhista Técnico Pericial (8) - 4 atribuições.

  4.6 - Auxiliar de Necrópsia Policial (9) - 3 atribuições.

  4.7 - Atendente de Necrotério Policial (10) - 2 atribuições.

5. O Médico Legista (4) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (3 - já listado)) e todos de apoio à perícia, entre eles:

  5.1 - Papiloscopista Policial (5) - 8 atribuições.

  5.2 - Auxiliar de Papiloscopista Policial (6) - 3 atribuições.
  
  5.3 - Fotógrado Técnico Pericial (7) - 2 atribuições.

  5.4 - Desenhista Técnico Pericial (8) - 2 atribuições.

  5.5 - Auxiliar de Necrópsia Policial (9) - 7 atribuições.

  5.6 - Atendente de Necrotério Policial (10) - 6 atribuições.

6. O Papiloscopista Policial (5) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (3) e Médico Legista (4 - já listados)) e todos de apoio à perícia, entre eles:

  6.1 - Auxiliar de Papiloscopista Policial (6) - 12 atribuições.

  6.2 - Fotógrado Técnico Pericial (7) - 2 atribuições.

  6.2 - Desenhista Técnico Pericial (8) - 5 atribuições.

  6.3 - Auxiliar de Necrópsia Policial (9) - 3 atribuições.

  6.4 - Atendente de Necrotério Policial (10) - 2 atribuições.

7. O Auxiliar de Papiloscopista Policial (6) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (3), Médico Legista (4) e Papiloscopista Policial (5 - já listados)) e todos de apoio à perícia, entre eles:

  7.1 - Fotógrado Técnico Pericial (7) - 2 atribuições.

  7.2 - Desenhista Técnico Pericial (8) - 3 atribuições.

  7.3 - Auxiliar de Necrópsia Policial (9) - 2 atribuições.

  7.4 - Atendente de Necrotério Policial (10) - 2 atribuições.

8. O Fotógrafo Técnico Pericial (7) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (3), Médico Legista (4) e Papiloscopista Policial (5 - já listados)) e todos de apoio à perícia (Auxiliar Papiloscopista Policial (6 - já listado), entre eles:

  8.1 - Desenhista Técnico Pericial (8) - 3 atribuições.

  8.2 - Auxiliar de Necrópsia Policial (9) - 2 atribuições.

  8.3 - Atendente de Necrotério Policial (10) - 2 atribuições.

9. O Desenhista Técnico Pericial (8) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (3), Médico Legista (4) e Papiloscopista Policial (5 - já listados)) e todos de apoio à perícia (Auxiliar Papiloscopista Policial (6) e Fotógrafo Técnico Pericial (7 - já listados), entre eles:

  9.1 - Auxiliar de Necrópsia Policial (9) - 2 atribuições.

  9.2 - Atendente de Necrotério Policial (10) - 2 atribuições.

10. O Auxiliar de Necrópsia Policial (9) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (3), Médico Legista (4) e Papiloscopista Policial (5 - já listados)) e todos de apoio à perícia (Auxiliar Papiloscopista Policial (6), Fotógrafo Técnico Pericial (7) e Desenhista Técnico Pericial (8 - já listados)), e possuí 1 atributo compartilhado com Atendente Técnico Policial (10).

11. O Atendente de Necrotério Policial (10) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (3), Médico Legista (4) e Papiloscopista Policial (5 - já listados)) e todos de apoio à perícia (Auxiliar Papiloscopista Policial (6), Fotógrafo Técnico Pericial (7) e Desenhista Técnico Pericial (8) e Auxiliar de Necrotério Policial - já listados)).

No geral, o Delegado de Polícia não se conecta com nenhum cargo. Houve conexão cargos de investigação e um espúria entre Investigador de Polícia com Desenhista Técnico Pericial. Cargos periciais e de apoio à perícia apresenta sólidas conexões entre si tanto em arestas como em atribuições.

Diagrama de grafos sem a legenda.
"""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo):
  fig = plt.figure(figsize=(8,8))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    if (cargo in cor_cargos_delegado):
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      cor = "lightgreen"
    else:
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos Clean
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Escrivão de Polícia", "Investigador de Polícia (+ Agente de Telecomunicações Policial + Agente Policial + Carcereiro Policial)"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Papiloscopista Policial"]
cargos_papiloscopia = []
cargos_apoio_investigacao = []
cargos_apoio_pericia = ["Auxiliar de Papiloscopista Policial", "Fotógrafo Técnico Pericial",
            "Desenhista Técnico Pericial", "Auxiliar de Necrópsia Policial", "Atendente de Necrotério Policial"]
titulo = 'Diagrama de Grafos - Cargos Atuais, Com Correções'

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_atual_withcor,
               titulo)

"""##5.3 LONPC sem correção
Inicialmente, contruir a matriz de adjacência e as arestas.
"""

titulo = 'Cargos LONPC sem correções'

matrix_adjacencia(cargos_atrib_LONPC_nocor, titulo)

"""Matrix de adjacência colorida."""

titulo = "Tabela Adjacência com pesos- LONPC Sem Correção"
color_map = "PuOr"

heatmap_tabela_adj(atrib_gerais_LONPC_no_cor, matrix_adj, arestas, titulo, color_map)

"""Plotando Diagrama de Grafos."""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo,
                   tamanho_fonte):
  fig = plt.figure(figsize=(12,12))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)
  legenda_inicial = mpatches.Patch(color='white', label='LEGENDA:')
  handles = [legenda_inicial]

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    descricao_legenda = str(i)+": "+cargo
    if (cargo in cor_cargos_delegado):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"azul"
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"vermelho"
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"roxo"
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"cinza"
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"laranja"
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"verde"
      cor = "lightgreen"
    else:
      nome_variavel_legenda = "erro_legenda"
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    patch = mpatches.Patch(color=cor, label=descricao_legenda)
    handles.append(patch)
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
    #legendas das arestas
    nome_variavel_legenda = "aresta_"+str(arestas[i][0])+"_"+str(arestas[i][1])
    descricao_legenda = str(arestas[i][0])+" "+df["Carreira"].iloc[arestas[i][0]]+' <-> '+str(arestas[i][1])+" "+df["Carreira"].iloc[arestas[i][1]]+' - Peso: ' + str(peso)
    patch = mpatches.Patch(color='black', label=descricao_legenda)
    handles.append(patch)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  aresta_outro = mpatches.Patch(color='white', label='outros cargos: Peso 0 <-> Sem conexão')
  handles.append(aresta_outro)

  font_prop = fm.FontProperties(size=tamanho_fonte) # Use fm instead of plt.font_manager

  plt.legend(handles=handles, bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0., prop=font_prop)

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Oficial Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Perito Papiloscopista"]
cargos_papiloscopia = []
cargos_apoio_investigacao = []
cargos_apoio_pericia = ["Agente de Perícia Papiloscópica", "Agente de Perícia Criminalística",
            "Agente de Perícia Médico Legal"]
titulo = 'Diagrama de Grafos - LONPC, sem Correções'

tamanho_fonte = 16

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_LONPC_nocor,
               titulo, tamanho_fonte)

atrib_comp_cargos(atrib_gerais_LONPC_no_cor)

"""Observando o Diagrama, percebe-se que (a lista de atribuições compartilhadas está acima para conferência):

1. Delegado de Polícia (0) não possuí atribuições compartilhadas.

2. Oficial Investigador de Polícia (1) não possuí atribuições compartilhadas.

3. O Perito Criminal (2) possuí atribuições compartilhadas com todos os cargos pericias e todos de apoio à perícia, entre eles:

  3.1 - Médico Legista (3) - 3 atribuições.

  3.2 - Perito Papiloscopista (4) - 2 atribuições.

  3.3 - Agente de Perícia Papiloscópica (5) - 2 atribuições.

  3.4 - Agente de Perícia Criminalística (6) - 1 atribuição.

  3.5 - Agente de Perícia Médico Legal (7) - 1 atribuição.

4. O Médico Legista (3) possuí atribuições compartilhadas o Perito Criminal (2 - já listado) e dois cargos de apoio à perícia, entre eles:
  
  4.1 - Agente de Perícia Criminalística (6) - 1 atribuição.

  4.2 - Agente de Perícia Médico Legal (7) - 1 atribuição.

5. O Perito Papiloscopista (4) possuí atribuições compartilhadas com Perito Criminal (2 - já listado) e o Agente de Perícia Papiloscópica (5), este com 2 atribuições compartilhadas.

6. O Agente de Perícia Papiloscópica (5) possuí atribuições compartilhadas com o Perito Criminal (3) e Papiloscopista Policial (5), ambos já listados.

7. O Agente de Perícia Criminalística (6) possuí atribuições compartilhadas com o Perito Criminal (3) e o  Médico Legista (4), ambos já listados.

8. O Agente de Perícia Médico Legal (7) possuí atribuições compartilhadas com o Perito Criminal (3) e o  Médico Legista (4), ambos já listados.

No geral, o Delegado de Polícia não se conecta com nenhum cargo. O mesmo ocorre com o Oficial Investigador de Polícia. Cargos periciais e de apoio à perícia apresentam mais conexões entre si tanto em arestas como em atribuições, apesar de algumas lacunas devido as ausência de correções.

Diagrama de grafos sem a legenda.
"""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo):
  fig = plt.figure(figsize=(8,8))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    if (cargo in cor_cargos_delegado):
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      cor = "lightgreen"
    else:
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos Clean
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Oficial Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Perito Papiloscopista"]
cargos_papiloscopia = []
cargos_apoio_investigacao = []
cargos_apoio_pericia = ["Agente de Perícia Papiloscópica", "Agente de Perícia Criminalística",
            "Agente de Perícia Médico Legal"]
titulo = 'Diagrama de Grafos - LONPC, sem Correções'

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_LONPC_nocor,
               titulo)

"""##5.4 LONPC com correção
Inicialmente, contruir a matriz de adjacência e as arestas.
"""

titulo = 'Cargos LONPC com correções'

matrix_adjacencia(cargos_atrib_LONPC_withcor, titulo)

"""Matrix de adjacência colorida."""

titulo = "Tabela Adjacência com pesos- LONPC Com Correção"
color_map = "RdBu"

heatmap_tabela_adj(atrib_gerais_LONPC_with_cor, matrix_adj, arestas, titulo, color_map)

"""Plotando Diagrama de Grafos."""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo,
                   tamanho_fonte):
  fig = plt.figure(figsize=(12,12))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)
  legenda_inicial = mpatches.Patch(color='white', label='LEGENDA:')
  handles = [legenda_inicial]

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    descricao_legenda = str(i)+": "+cargo
    if (cargo in cor_cargos_delegado):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"azul"
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"vermelho"
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"roxo"
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"cinza"
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"laranja"
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"verde"
      cor = "lightgreen"
    else:
      nome_variavel_legenda = "erro_legenda"
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    patch = mpatches.Patch(color=cor, label=descricao_legenda)
    handles.append(patch)
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
    #legendas das arestas
    nome_variavel_legenda = "aresta_"+str(arestas[i][0])+"_"+str(arestas[i][1])
    descricao_legenda = str(arestas[i][0])+" "+df["Carreira"].iloc[arestas[i][0]]+' <-> '+str(arestas[i][1])+" "+df["Carreira"].iloc[arestas[i][1]]+' - Peso: ' + str(peso)
    patch = mpatches.Patch(color='black', label=descricao_legenda)
    handles.append(patch)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  aresta_outro = mpatches.Patch(color='white', label='outros cargos: Peso 0 <-> Sem conexão')
  handles.append(aresta_outro)

  font_prop = fm.FontProperties(size=tamanho_fonte) # Use fm instead of plt.font_manager

  plt.legend(handles=handles, bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0., prop=font_prop)

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Oficial Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Perito Papiloscopista"]
cargos_papiloscopia = []
cargos_apoio_investigacao = []
cargos_apoio_pericia = ["Agente de Perícia Papiloscópica", "Agente de Perícia Criminalística",
            "Agente de Perícia Médico Legal"]
titulo = 'Diagrama de Grafos - LONPC, com Correções'

tamanho_fonte = 14

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_LONPC_withcor,
               titulo, tamanho_fonte)

atrib_comp_cargos(atrib_gerais_LONPC_with_cor)

"""Observando o Diagrama, percebe-se que (a lista de atribuições compartilhadas está acima para conferência):

1. Delegado de Polícia (0) não possuí atribuições compartilhadas.

2. Oficial Investigador de Polícia (1) não possuí atribuições compartilhadas.

3. O Perito Criminal (2) possuí atribuições compartilhadas com todos os cargos pericias e todos de apoio à perícia, entre eles:

  3.1 - Médico Legista (3) - 8 atribuições.

  3.2 - Perito Papiloscopista (4) - 10 atribuições.

  3.3 - Agente de Perícia Papiloscópica (5) - 6 atribuições.

  3.4 - Agente de Perícia Criminalística (6) - 6 atribuições.

  3.5 - Agente de Perícia Médico Legal (7) - 3 atribuições.

4. O Médico Legista (3) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (2 - já listado)) e todos de apoio à perícia, entre eles:
  
  4.1 - Perito Papiloscopista (4) - 7 atribuições.

  4.2 - Agente de Perícia Papiloscópica (5) - 3 atribuições.

  4.3 - Agente de Perícia Criminalística (6) - 2 atribuições.

  4.4 - Agente de Perícia Médico Legal (7) - 11 atribuições.

5. O Perito Papiloscopista (4) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (2) e o Médico Legista (3 - já listados)) e todos de apoio à perícia, entre eles:

  5.1 - Agente de Perícia Papiloscópica (5) - 12 atribuições.

  5.2 - Agente de Perícia Criminalística (6) - 4 atribuições.

  5.4 - Agente de Perícia Médico Legal (7) - 2 atribuições.

6. O Agente de Perícia Papiloscópica (5) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (2), o Médico Legista (3) e o Perito Papiloscopista (4 - já listados)) e todos de apoio à perícia, entre eles:

  6.1 - Agente de Perícia Criminalística (6) - 2 atribuições.

  6.2 - Agente de Perícia Médico Legal (7) - 2 atribuições.

7. O Agente de Perícia Criminalística (6) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (2), o Médico Legista (3) e o Perito Papiloscopista (4 - já listados)) e todos de apoio à perícia (Agente de Perícia Papiloscópica (5 - Já listado)), e com o Agente de Perícia Médico Legal, com 2 atribuições.

8. O Agente de Perícia Médico Legal (7) possuí atribuições compartilhadas com todos os cargos pericias (Perito Criminal (2), o Médico Legista (3) e o Perito Papiloscopista (4 - já listados)) e todos de apoio à perícia (Agente de Perícia Papiloscópica (5) e Agente de Perícia Criminalística (6 - Já listados)).

No geral, o Delegado de Polícia não se conecta com nenhum cargo. O mesmo ocorre com o Oficial Investigador de Polícia. Cargos periciais e de apoio à perícia apresentam sólidas conexões entre si tanto em arestas como em atribuições.

Diagrama de grafos sem a legenda.
"""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo):
  fig = plt.figure(figsize=(8,8))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    if (cargo in cor_cargos_delegado):
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      cor = "lightgreen"
    else:
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos Clean
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Oficial Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista", "Perito Papiloscopista"]
cargos_papiloscopia = []
cargos_apoio_investigacao = []
cargos_apoio_pericia = ["Agente de Perícia Papiloscópica", "Agente de Perícia Criminalística",
            "Agente de Perícia Médico Legal"]
titulo = 'Diagrama de Grafos - LONPC, com Correções'

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_LONPC_withcor,
               titulo)

"""## 5.5 Reestruturação proposta pela PCSP 2024
Inicialmente, contruir a matriz de adjacência e as arestas.
"""

titulo = 'Cargos Reestruturação PCSP 2024'

matrix_adjacencia(cargos_atrib_restr, titulo)

"""Matrix de adjacência colorida."""

titulo = "Tabela Adjacência com pesos- Reestruturação PCSP 2024"
color_map = "RdYlBu"

heatmap_tabela_adj(atrib_gerais_restr, matrix_adj, arestas, titulo, color_map)

"""Plotando Diagrama de Grafos. Aqui, retorna o apoio à investigação e o Pàpiloscopista Policial, pela sua redução pericial e verificação de proximidade, fica em cor separada (cinza)."""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo,
                   tamanho_fonte):
  fig = plt.figure(figsize=(12,12))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)
  legenda_inicial = mpatches.Patch(color='white', label='LEGENDA:')
  handles = [legenda_inicial]

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    descricao_legenda = str(i)+": "+cargo
    if (cargo in cor_cargos_delegado):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"azul"
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"vermelho"
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"roxo"
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"cinza"
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"laranja"
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      nome_variavel_legenda = "cargo_"+str(cargo)+"_"+"verde"
      cor = "lightgreen"
    else:
      nome_variavel_legenda = "erro_legenda"
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    patch = mpatches.Patch(color=cor, label=descricao_legenda)
    handles.append(patch)
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
    #legendas das arestas
    nome_variavel_legenda = "aresta_"+str(arestas[i][0])+"_"+str(arestas[i][1])
    descricao_legenda = str(arestas[i][0])+" "+df["Carreira"].iloc[arestas[i][0]]+' <-> '+str(arestas[i][1])+" "+df["Carreira"].iloc[arestas[i][1]]+' - Peso: ' + str(peso)
    patch = mpatches.Patch(color='black', label=descricao_legenda)
    handles.append(patch)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  aresta_outro = mpatches.Patch(color='white', label='outros cargos: Peso 0 <-> Sem conexão')
  handles.append(aresta_outro)

  font_prop = fm.FontProperties(size=tamanho_fonte) # Use fm instead of plt.font_manager

  plt.legend(handles=handles, bbox_to_anchor=(1.05, 1), loc='upper left', borderaxespad=0., prop=font_prop)

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Escrivão de Polícia", "Oficial Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista"]
cargos_papiloscopia = ["Papiloscopista Policial"]
cargos_apoio_investigacao = ["Agente de Polícia Judiciária"]
cargos_apoio_pericia = ["Agente de Perícia Criminalística",
            "Agente de Perícia Médico Legal"]
titulo = 'Diagrama de Grafos - Reestruturação PCSP 2024'

tamanho_fonte = 16

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_restr,
               titulo, tamanho_fonte)

atrib_comp_cargos(atrib_gerais_restr)

"""Observando o Diagrama, percebe-se que (a lista de atribuições compartilhadas está acima para conferência):

1. Delegado de Polícia (0) não possuí atribuições compartilhadas.

2. O Escrivão de Polícia (1) possuí atribuições compartilhadas com os cargos de investigação e apoio à investigação, entre eles:

  2.1 - Oficial Investigador de Polícia (2) - 1 atribuição.

  2.2 - Agente de Polícia Judiciária (6) - 1 atribuição.

3. O Oficial Investigador de Polícia (2) possuí atribuições compartilhadas com o cargo de investigação (Escrivão de Polícia (1 - já listado)) e com o Agente de Polícia Judiciária (6), com 8 atribuições.

4. O Perito Criminal (3) possuí atribuições compartilhadas com os cargos de perícia, apoio à perícia e papiloscopia, entre eles:

  4.1 - Médico Legista (4) - 8 atribuições.

  4.2 - Papiloscopista Policial (5) - 1 atribuição.

  4.3 - Agente de Perícia Criminalística (7) - 7 atribuições.

  4.4 - Agente de Perícia Médico Legal (8) - 3 atribuições.

5. O Médico Legista possuí atribuições compartilhadas com os cargos de perícia (Perito Criminal (3 - já listado)), apoio à perícia e papiloscopia, entre eles:

  5.1 - Papiloscopista Policial (5) - 2 atribuições.

  5.2 - Agente de Perícia Criminalística (7) - 3 atribuições.

  5.3 - Agente de Perícia Médico Legal (8) - 11 atribuições.

6. O Papiloscopista Policial (5) possuí atribuições compartilhadas com os cargos de perícia (Perito Criminal (3) e Médico Legista (4 - já listado)), apoio à perícia e papiloscopia, entre eles:

  6.1 - Agente de Perícia Criminalística (7) - 2 atribuições.

  5.3 - Agente de Perícia Médico Legal (8) - 3 atribuições.

7. O Agente de Polícia Judiciária (6) possuí atribuições compartilhadas com os cargos de investigação (Escrivão de Polícia (1) e Oficial Investigador de Polícia (2 - já listado))

8. O Agente de Perícia Criminalística (7) possuí atribuições compartilhadas com os cargos de perícia (Perito Criminal (3) e Médico Legista (4 - já listado)), Papiloscopia (Papiloscopista Policial (5 - já listado)) e apoio à perícia, com o Agente de Perícia Médico Legal (8) com 3 atribuições.

9. O Agente de Perícia Médico Legal (8) possuí possuí atribuições compartilhadas com os cargos de perícia (Perito Criminal (3) e Médico Legista (4 - já listado)), Papiloscopia (Papiloscopista Policial (5 - já listado)) e apoio à perícia (Agente de Perícia Criminalística (7 - já listado)).

Com a restruturação, há a criação de um grupo de investigação (Oficial Investigador e Escrivão de Polícia) conectado com o apoio à investigação (Agente de Polícia Judiciária).

Os peritos explícitos (Perito Criminal e Médico Legista) continuam bem conectado, assim como seus apoios (Agente de Perícia Criminalística e Agente de Perícia Médico Legal), formando um grande gupos relacionado a perícia.

O Papiloscopista Policial continua minimamente conectado com o grande grupo de Perícia, mas minimamente, com poucas atribuições compartilhadas. Esse fato pode ocorrer para que a carreira não deixe de existir e continue com suas atribuições, de forma a ficar separada suficiente das perícias e não alçar novos patamares periciais, mantendo a situação paradoxal de perícia não pericial.

Diagrama de grafos sem a legenda.
"""

#Plotando Diagrama de Grafos
def diagrama_grafo(cargos_delegado, cargos_investigacao,
                   cargos_pericia, cargos_papiloscopia,
                   cargos_apoio_investigacao, cargos_apoio_pericia, df, titulo):
  fig = plt.figure(figsize=(8,8))

  #Matrix de Adjacência
  G = nx.from_numpy_array(matrix_adj)

  #Color Mapping e Legenda Cargos
  color_map = []
  cor_cargos_delegado = cargos_delegado
  cor_cargos_investigacao = cargos_investigacao
  cor_cargos_pericia = cargos_pericia
  cor_cargos_papiloscopia = cargos_papiloscopia
  cor_cargos_apoio_investigacao = cargos_apoio_investigacao
  cor_cargos_apoio_pericia = cargos_apoio_pericia
  lista_pesos = []

  for i, cargo in enumerate(df["Carreira"]):
    if (cargo in cor_cargos_delegado):
      cor = "lightblue"
    elif (cargo in cor_cargos_investigacao):
      cor = "tomato"
    elif (cargo in cor_cargos_pericia):
      cor = "violet"
    elif (cargo in cor_cargos_papiloscopia):
      cor = "gray"
    elif (cargo in cor_cargos_apoio_investigacao):
      cor = "orange"
    elif cargo in (cor_cargos_apoio_pericia):
      cor = "lightgreen"
    else:
      cor = "black"
    #Criando os patches e adicionando a legenda ao handles
    color_map.append(cor)

  #Arestas e pesos
  peso_max = 0
  labels_arestas = []
  for i in range(len(arestas)):
    inicio_aresta = arestas[i][0]
    fim_aresta = arestas[i][1]
    peso = arestas[i][2]
    if peso > peso_max:
      peso_max = peso
    G.add_edge(inicio_aresta, fim_aresta, weight=peso)
  edge_weights = nx.get_edge_attributes(G, 'weight')
  width_scale = peso_max
  min_width = 1
  widths = [(edge_weights[edge] - min(edge_weights.values())) /
            (max(edge_weights.values()) - min(edge_weights.values())) *
            width_scale + min_width for edge in G.edges()]

  nx.draw_circular(G, node_color=color_map, with_labels=True, width=widths)
  nx.draw_networkx_edge_labels(G, pos=nx.circular_layout(G), label_pos=0.35)

  plt.title(titulo)
  plt.show()

#Plotando Diagrama de Grafos Clean
cargos_delegado = ["Delegado de Polícia"]
cargos_investigacao = ["Escrivão de Polícia", "Oficial Investigador de Polícia"]
cargos_pericia = ["Perito Criminal", "Médico Legista"]
cargos_papiloscopia = ["Papiloscopista Policial"]
cargos_apoio_investigacao = ["Agente de Polícia Judiciária"]
cargos_apoio_pericia = ["Agente de Perícia Criminalística",
            "Agente de Perícia Médico Legal"]
titulo = 'Diagrama de Grafos - Reestruturação PCSP 2024'

diagrama_grafo(cargos_delegado, cargos_investigacao, cargos_pericia,
               cargos_papiloscopia, cargos_apoio_investigacao,
               cargos_apoio_pericia, cargos_atrib_restr,
               titulo)

"""## 5.6 Comentários Gerais
Observando o diagrama de grafos da situação atual sem correção, é possível verificar muitas conexões entre cargos periciais e de apoio à perícia. Essas conexões possuem pesos baixos, mas demonstram a tendência de proximidade dos cargos periciais, incluindo Papiloscopista Policial e Perito Criminal.

Ao se corrigir as atribuições, as conexões aumentam em peso e número nos cargos já citados, indicando ainda mais essa malha.

Mesmo na situação de adequação a LONPC sem correções, há conexões somente entre peritos e apoio à perícia, ainda que com baixos pesos.

Com as correções propostas, a malha se aumenta e reforça.

Em nenhuma situação, Papiloscopista Policial e Investigadores de Polícia tiveram conexão. Todavia, as restruturação enfraquece as conexões entre o Papiloscopista Policial e o grande grupo de Perícia, separando-o e reduzindo-o a atividade policial não pericial.

#6 - Conclusões sobre o estudo
Na maioria das visualizações, Papiloscopistas Policiais estão mais próximos dos Peritos Criminais do que de Investigadores de Polícia. Ademais, muitas das atribuições são periciais idênticas entre os Peritos Criminais e Papiloscopista.

A indicação de Perito na área de Identificação pela LONPC deve ser feita por Perito da área. O Papiloscopista não é afeita a investigação, e realiza perícia na área da identificação. Logo, é o Perito da Identificação, no ramo biométrico, em especial o papiloscópico.

Este estudo indica a similaridade, mas questões políticas, científicas e jurídicas também devem ser levadas em conta. Esse estudo tem por objetivo indicar a situação centenária dos Papiloscopista Policiais com a perícia, evitando disparates feito contra a ciência e seus profissionais. O teste feito em relação a reestruturação indica os caminhas tomados, e para que direção a PCSP deseja ruamr em relação ao Papiloscopista Policial e a Papiloscopia. A manutenção de seu status não pericial a despeito do potencial de crescimento da ciência, carreira e utilização na investigação e ação penal é aparentemente o enfoque da direção atual das PCPS frente as novidades legislativas e judiciais, dermonstrando ostracismo no executivo da segurança pública.

Em respeito a pluralidade de ideias e da construção do conhecimento científico, é possível alteração de valores e dados para verificação dos resultados. Estima-se a metotologia de caixa branca apresentada, com todos os processos sendo indicados, e que em todas as esferas tal situação seja feita, com respeito a todos e levando-se em conta todos os direitos e deveres.
"""